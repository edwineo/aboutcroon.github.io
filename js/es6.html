<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES2016-ES2021新特性 | Chang Liu</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/hero.JPG">
    <meta name="description" content="Replace the stars and rivers in the body with unlimited methods for the future">
    
    <link rel="preload" href="/assets/css/0.styles.a7f15fef.css" as="style"><link rel="preload" href="/assets/js/app.783a6ee2.js" as="script"><link rel="preload" href="/assets/js/2.5a5ecfa5.js" as="script"><link rel="preload" href="/assets/js/13.0bc6ce2c.js" as="script"><link rel="prefetch" href="/assets/js/10.930de106.js"><link rel="prefetch" href="/assets/js/11.aa3cc023.js"><link rel="prefetch" href="/assets/js/12.dcec06ad.js"><link rel="prefetch" href="/assets/js/14.5819cd37.js"><link rel="prefetch" href="/assets/js/15.e2a5d174.js"><link rel="prefetch" href="/assets/js/16.048335b4.js"><link rel="prefetch" href="/assets/js/17.a2a10b60.js"><link rel="prefetch" href="/assets/js/18.e858c77d.js"><link rel="prefetch" href="/assets/js/19.3afed449.js"><link rel="prefetch" href="/assets/js/20.10250f3f.js"><link rel="prefetch" href="/assets/js/21.415c0272.js"><link rel="prefetch" href="/assets/js/3.60419601.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.f3e6ed41.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.bed22aa2.js"><link rel="prefetch" href="/assets/js/8.67be8f05.js"><link rel="prefetch" href="/assets/js/9.fb3321fe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a7f15fef.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Chang Liu</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="目录" class="dropdown-title"><span class="title">目录</span> <span class="arrow down"></span></button> <button type="button" aria-label="目录" class="mobile-dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link router-link-active">
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/" class="nav-link">
  Vue3源码分析
</a></li><li class="dropdown-item"><!----> <a href="/standard/" class="nav-link">
  前端规范
</a></li><li class="dropdown-item"><!----> <a href="/code/" class="nav-link">
  源码分析
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.cn/user/4186540684871485" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/aboutcroon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="目录" class="dropdown-title"><span class="title">目录</span> <span class="arrow down"></span></button> <button type="button" aria-label="目录" class="mobile-dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link router-link-active">
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/" class="nav-link">
  Vue3源码分析
</a></li><li class="dropdown-item"><!----> <a href="/standard/" class="nav-link">
  前端规范
</a></li><li class="dropdown-item"><!----> <a href="/code/" class="nav-link">
  源码分析
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.cn/user/4186540684871485" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/aboutcroon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/js/" aria-current="page" class="sidebar-link">前言</a></li><li><a href="/js/prototype.html" class="sidebar-link">原型与原型链</a></li><li><a href="/js/extends.html" class="sidebar-link">继承</a></li><li><a href="/js/es6.html" aria-current="page" class="active sidebar-link">ES2016-ES2021新特性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/es6.html#_1-1-let-与-const" class="sidebar-link">1.1 let 与 const</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-2-解构赋值" class="sidebar-link">1.2 解构赋值</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-3-symbol" class="sidebar-link">1.3 Symbol</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-4-map" class="sidebar-link">1.4 Map</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-5-set" class="sidebar-link">1.5 Set</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-6-函数" class="sidebar-link">1.6 函数</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-7-class" class="sidebar-link">1.7 Class</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-8-字符串" class="sidebar-link">1.8 字符串</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-9-数值" class="sidebar-link">1.9 数值</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-10-对象" class="sidebar-link">1.10 对象</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-11-数组" class="sidebar-link">1.11 数组</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-12-迭代器" class="sidebar-link">1.12 迭代器</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-13-模块" class="sidebar-link">1.13 模块</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-14-proxy" class="sidebar-link">1.14 Proxy</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-15-reflect" class="sidebar-link">1.15 Reflect</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-16-promise-对象" class="sidebar-link">1.16 Promise 对象</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_1-17-generator-函数" class="sidebar-link">1.17 Generator 函数</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_2-1-array-prototype-includes" class="sidebar-link">2.1 Array.prototype.includes()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_2-2-求幂运算符" class="sidebar-link">2.2 求幂运算符</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_3-1-字符串补全" class="sidebar-link">3.1 字符串补全</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_3-2-object-values" class="sidebar-link">3.2 Object.values()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_3-3-object-entries" class="sidebar-link">3.3 Object.entries()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_3-4-object-getownpropertydescriptors" class="sidebar-link">3.4 Object.getOwnPropertyDescriptors()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_3-5-函数参数列表中和函数调用中的尾随逗号" class="sidebar-link">3.5 函数参数列表中和函数调用中的尾随逗号</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_3-6-async-函数" class="sidebar-link">3.6 Async 函数</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_3-7-共享内存-sharedarraybuffer-和-atomics" class="sidebar-link">3.7 共享内存（SharedArrayBuffer）和 Atomics</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_4-1-展开运算符" class="sidebar-link">4.1 展开运算符（...）</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_4-2-asynchronous-iteration-异步迭代" class="sidebar-link">4.2 Asynchronous iteration（异步迭代）</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_4-3-promise-prototype-finally" class="sidebar-link">4.3 Promise.prototype.finally</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_4-4-正则表达式改进" class="sidebar-link">4.4 正则表达式改进</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-1-string-prototype-trimstart-和-string-prototype-trimend" class="sidebar-link">5.1 String.prototype.trimStart() 和 String.prototype.trimEnd()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-2-object-fromentries" class="sidebar-link">5.2 Object.fromEntries()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-3-array-prototype-flat-和-array-prototype-flatmap" class="sidebar-link">5.3 Array.prototype.flat() 和 Array.prototype.flatMap()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-4-catch-的参数改为可选" class="sidebar-link">5.4 catch 的参数改为可选</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-5-symbol-prototype-description" class="sidebar-link">5.5 Symbol.prototype.description</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-6-json-superset-超集" class="sidebar-link">5.6 JSON superset（超集）</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-7-json-stringify" class="sidebar-link">5.7 JSON.stringify</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-8-array-prototype-sort-变得更加稳定" class="sidebar-link">5.8 Array.prototype.sort() 变得更加稳定</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_5-9-function-prototype-tostring-的重新修订" class="sidebar-link">5.9 Function.prototype.toString() 的重新修订</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-1-class-的私有变量" class="sidebar-link">6.1 class 的私有变量</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-2-promise-allsettled" class="sidebar-link">6.2 Promise.allSettled</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-3-空位合并运算符" class="sidebar-link">6.3 空位合并运算符（.?）</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-4-可选链" class="sidebar-link">6.4 可选链（.?）</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-5-bigint" class="sidebar-link">6.5 BigInt</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-6-动态-import" class="sidebar-link">6.6 动态 import</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-7-globalthis" class="sidebar-link">6.7 globalThis</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-8-string-prototype-matchall" class="sidebar-link">6.8 String.prototype.matchAll()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-9-for-in-mechanics" class="sidebar-link">6.9 for-in mechanics</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_6-10-import-meta" class="sidebar-link">6.10 import.meta</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_7-1-string-prototype-replaceall" class="sidebar-link">7.1 String.prototype.replaceAll()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_7-2-promise-any" class="sidebar-link">7.2 Promise.any()</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_7-3-逻辑赋值操作符-logical-assignment-operators" class="sidebar-link">7.3 逻辑赋值操作符（Logical Assignment Operators）</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_7-4-数值分隔符-numeric-separators" class="sidebar-link">7.4 数值分隔符（Numeric separators）</a></li><li class="sidebar-sub-header"><a href="/js/es6.html#_7-5-weakref" class="sidebar-link">7.5 WeakRef</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="es2016-es2021新特性"><a href="#es2016-es2021新特性" class="header-anchor">#</a> ES2016-ES2021新特性</h1> <h1 id="一、es2015"><a href="#一、es2015" class="header-anchor">#</a> 一、ES2015</h1> <h2 id="_1-1-let-与-const"><a href="#_1-1-let-与-const" class="header-anchor">#</a> 1.1 let 与 const</h2> <p>let 声明的变量只在 let 命令所在的代码块内有效。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 

a  <span class="token comment">// ReferenceError: a is not defined</span>
b  <span class="token comment">// 1</span>
</code></pre></div><p>const 声明一个只读的常量，一旦声明，常量的值就不能改变。这也意味着，一旦声明必须初始化，否则会报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token string">&quot;3.1415926&quot;</span><span class="token punctuation">;</span>
<span class="token constant">PI</span>  <span class="token comment">// 3.1415926</span>

<span class="token keyword">const</span> <span class="token constant">MY_AGE</span><span class="token punctuation">;</span>  <span class="token comment">// SyntaxError: Missing initializer in const declaration </span>
</code></pre></div><p>暂时性死区：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ReferenceError: PI is not defined </span>
  <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token string">&quot;3.1415926&quot;</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><p>ES6 明确规定，代码块内如果存在 let 或者 const，代码块会对这些命令声明的变量从块的开始就形成一个封闭作用域。代码块内，在声明变量 PI 之前使用它会报错。</p> <h2 id="_1-2-解构赋值"><a href="#_1-2-解构赋值" class="header-anchor">#</a> 1.2 解构赋值</h2> <p>解构赋值是对赋值运算符的扩展。</p> <p>他是一种针对数组或者对象进行模式匹配，然后对其中的变量进行赋值。</p> <p>在解构中，有下面两部分参与：</p> <ol><li>解构的源：解构赋值表达式的右边部分</li> <li>解构的目标：解构赋值表达式的左边部分</li></ol> <h3 id="_1-2-1-数组的解构"><a href="#_1-2-1-数组的解构" class="header-anchor">#</a> 1.2.1 数组的解构</h3> <p>基本</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token comment">// a = 1 </span>
<span class="token comment">// b = 2 </span>
<span class="token comment">// c = 3</span>
</code></pre></div><p>可嵌套</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token comment">// a = 1 </span>
<span class="token comment">// b = 2 </span>
<span class="token comment">// c = 3</span>
</code></pre></div><p>可忽略</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> <span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token comment">// a = 1 </span>
<span class="token comment">// b = 3</span>
</code></pre></div><p>不完全解构</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">[</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token comment">// a = 1, b = undefined</span>
</code></pre></div><p>rest 运算符</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token comment">//a = 1</span>
<span class="token comment">//rest = [2, 3]</span>
</code></pre></div><p>字符串</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在数组的解构中，解构的目标若为可遍历对象，皆可进行解构赋值。可遍历对象即实现 Iterator 接口的数据。</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span> 
<span class="token comment">// a = 'h' </span>
<span class="token comment">// b = 'e' </span>
<span class="token comment">// c = 'l' </span>
<span class="token comment">// d = 'l' </span>
<span class="token comment">// e = 'o'</span>
</code></pre></div><h3 id="_1-2-2-对象的解构"><a href="#_1-2-2-对象的解构" class="header-anchor">#</a> 1.2.2 对象的解构</h3> <p>基本</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span> foo<span class="token punctuation">,</span> bar <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">'aaa'</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token string">'bbb'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// foo = 'aaa' </span>
<span class="token comment">// bar = 'bbb'  </span>

<span class="token keyword">let</span> <span class="token punctuation">{</span> baz <span class="token operator">:</span> foo <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> baz <span class="token operator">:</span> <span class="token string">'ddd'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token comment">// foo = 'ddd'</span>
</code></pre></div><p>可嵌套可忽略</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>p<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>y<span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token keyword">let</span> <span class="token punctuation">{</span>p<span class="token operator">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> <span class="token punctuation">{</span> y <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span> 
<span class="token comment">// x = 'hello' </span>
<span class="token comment">// y = 'world' </span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>p<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>y<span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">let</span> <span class="token punctuation">{</span>p<span class="token operator">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> <span class="token punctuation">{</span>  <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span> 
<span class="token comment">// x = 'hello'</span>
</code></pre></div><p>不完全解构</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>p<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>y<span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">let</span> <span class="token punctuation">{</span>p<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> y <span class="token punctuation">}</span><span class="token punctuation">,</span> x <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span> 
<span class="token comment">// x = undefined </span>
<span class="token comment">// y = 'world'</span>
</code></pre></div><p>rest 运算符</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> d<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token comment">// a = 10 </span>
<span class="token comment">// b = 20 </span>
<span class="token comment">// rest = {c: 30, d: 40}</span>
</code></pre></div><p>解构默认值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token comment">// a = 3; b = 5; </span>

<span class="token keyword">let</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> aa <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token operator">:</span> bb <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token comment">// aa = 3; bb = 5;</span>
</code></pre></div><h2 id="_1-3-symbol"><a href="#_1-3-symbol" class="header-anchor">#</a> 1.3 Symbol</h2> <p>一种新的原始数据类型 Symbol ，表示独一无二的值，最大的用法是用来定义对象的唯一属性名。</p> <p>Symbol 函数栈不能用 new 命令，因为 Symbol 是原始数据类型，不是对象。可以接受一个字符串作为参数，为新创建的 Symbol 提供描述，用来显示在控制台或者作为字符串的时候使用，便于区分。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> sy <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;KK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sy<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Symbol(KK) </span>
<span class="token keyword">typeof</span><span class="token punctuation">(</span>sy<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// &quot;symbol&quot;  </span>

<span class="token comment">// 相同参数 Symbol() 返回的值不相等 </span>
<span class="token keyword">let</span> sy1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;kk&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
sy <span class="token operator">===</span> sy1<span class="token punctuation">;</span>       <span class="token comment">// false</span>
</code></pre></div><p>由于每一个 Symbol 的值都是不相等的，所以 Symbol 可以作为对象的属性名，可以保证属性不重名。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> sy <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">// 写法1 </span>
<span class="token keyword">let</span> syObject <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
syObject<span class="token punctuation">[</span>sy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;kk&quot;</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>syObject<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// {Symbol(key1): &quot;kk&quot;}  </span>

<span class="token comment">// 写法2 </span>
<span class="token keyword">let</span> syObject <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token punctuation">[</span>sy<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;kk&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>syObject<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// {Symbol(key1): &quot;kk&quot;}  </span>

<span class="token comment">// 写法3 </span>
<span class="token keyword">let</span> syObject <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>syObject<span class="token punctuation">,</span> sy<span class="token punctuation">,</span> <span class="token punctuation">{</span>value<span class="token operator">:</span> <span class="token string">&quot;kk&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>syObject<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// {Symbol(key1): &quot;kk&quot;}</span>
</code></pre></div><p>Symbol 作为对象属性名时不能用.运算符，要用方括号。因为.运算符后面是字符串，所以取到的是字符串 sy 属性，而不是 Symbol 值 sy 属性。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> syObject <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> syObject<span class="token punctuation">[</span>sy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;kk&quot;</span><span class="token punctuation">;</span>  syObject<span class="token punctuation">[</span>sy<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;kk&quot; syObject.sy;   // undefined</span>
</code></pre></div><h2 id="_1-4-map"><a href="#_1-4-map" class="header-anchor">#</a> 1.4 Map</h2> <p>Map 对象保存键值对。任何值(对象或者原始值) 都可以作为一个键或一个值。</p> <p>Map 与 Object 的区别：</p> <ul><li>一个 Object 的键只能是字符串或者 Symbols，但一个 Map 的键可以是任意值。</li> <li>Map 中的键值是有序的（FIFO 原则），而添加到对象中的键则不是。</li> <li>Map 的键值对个数可以从 size 属性获取，而 Object 的键值对个数只能手动计算。</li> <li>Object 都有自己的原型，原型链上的键名有可能和你自己在对象上的设置的键名产生冲突。</li></ul> <h3 id="map-的迭代"><a href="#map-的迭代" class="header-anchor">#</a> Map 的迭代</h3> <p>for...of</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;zero&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token comment">// 将会显示两个 log。 一个是 &quot;0 = zero&quot; 另一个是 &quot;1 = one&quot;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> myMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 等价于</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> myMap<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 这个 entries 方法返回一个新的 Iterator 对象，它按插入顺序包含了 Map 对象中每个元素的 [key, value] 数组。 */</span>
  
 
<span class="token comment">// 将会显示两个log。 一个是 &quot;0&quot; 另一个是 &quot;1&quot;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">of</span> myMap<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 这个 keys 方法返回一个新的 Iterator 对象， 它按插入顺序包含了 Map 对象中每个元素的键。 */</span>
  
 
<span class="token comment">// 将会显示两个log。 一个是 &quot;zero&quot; 另一个是 &quot;one&quot;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> value <span class="token keyword">of</span> myMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 这个 values 方法返回一个新的 Iterator 对象，它按插入顺序包含了 Map 对象中每个元素的值。 */</span>
</code></pre></div><p>forEach()</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;zero&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token comment">// 将会显示两个 logs。 一个是 &quot;0 = zero&quot; 另一个是 &quot;1 = one&quot;</span>
myMap<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_1-5-set"><a href="#_1-5-set" class="header-anchor">#</a> 1.5 Set</h2> <p>Set 对象允许存储任何类型的唯一值，无论是原始值或者是对象引用。</p> <p>Set 对象存储的值总是唯一的，所以需要判断两个值是否恒等。有几个特殊值需要特殊对待：</p> <ul><li>+0 与 -0 在存储判断唯一性的时候是恒等的，所以不重复；</li> <li>undefined 与 undefined 是恒等的，所以不重复；</li> <li>NaN 与 NaN 是不恒等的，但是在 Set 中只能存一个，不重复。</li></ul> <p>基本示例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> mySet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
mySet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set(1) {1}</span>
mySet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set(2) {1, 5}</span>
mySet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set(2) {1, 5} 这里体现了值的唯一性</span>
mySet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;some text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set(3) {1, 5, &quot;some text&quot;} 这里体现了类型的多样性</span>
 
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
mySet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
mySet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set(5) {1, 5, &quot;some text&quot;, {…}, {…}}</span>
<span class="token comment">// 这里体现了对象之间引用不同不恒等，即使值相同，Set 也能存储</span>
</code></pre></div><h2 id="_1-6-函数"><a href="#_1-6-函数" class="header-anchor">#</a> 1.6 函数</h2> <h3 id="_1-6-1-默认参数"><a href="#_1-6-1-默认参数" class="header-anchor">#</a> 1.6.1 默认参数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age<span class="token operator">=</span><span class="token number">17</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">&quot;Amy&quot;</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Amy,18</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">&quot;Amy&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Amy,</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">&quot;Amy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Amy,17</span>
</code></pre></div><p>注意点：使用函数默认参数时，不允许有同名的参数。</p> <h3 id="_1-6-2-rest不定参数"><a href="#_1-6-2-rest不定参数" class="header-anchor">#</a> 1.6.2 rest不定参数</h3> <p>不定参数用来表示不确定参数个数，形如，...变量名，由...加上一个具名参数标识符组成。具名参数只能放在参数组的最后，并且有且只有一个不定参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>values</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//2</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//4</span>
</code></pre></div><h3 id="_1-6-3-箭头函数"><a href="#_1-6-3-箭头函数" class="header-anchor">#</a> 1.6.3 箭头函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token parameter">v</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">var</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">5</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">5</span> <span class="token punctuation">}</span>
</code></pre></div><p>如果箭头函数的代码块部分多于一条语句，就需要使用大括号将他们括起来。并且使用return返回：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>由于大括号被解释为代码块，所以如果箭头函数直接返回一个对象，必须在对象外面加上括号，否则会报错：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 报错</span>
<span class="token keyword">let</span> <span class="token function-variable function">getTempItem</span> <span class="token operator">=</span> <span class="token parameter">id</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> id<span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;Temp&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 不报错</span>
<span class="token keyword">let</span> <span class="token function-variable function">getTempItem</span> <span class="token operator">=</span> <span class="token parameter">id</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> id<span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&quot;Temp&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>箭头函数可以与变量解构结合使用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">full</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> first<span class="token punctuation">,</span> last <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> last<span class="token punctuation">;</span>
 
<span class="token comment">// 等同于</span>
<span class="token keyword">function</span> <span class="token function">full</span><span class="token punctuation">(</span><span class="token parameter">person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> person<span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>last<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>箭头函数有几个使用注意点：</p> <p>（1）函数体内的 <code>this</code> 对象，就是定义时所在的对象，而不是使用时所在的对象。</p> <p>（2）不可以当作构造函数，也就是说，不可以使用 <code>new</code> 命令，否则会抛出一个错误。</p> <p>（3）不可以使用 <code>arguments</code> 对象，该对象在函数体内不存在。如果要用，可以用 rest 参数代替。</p> <p>（4）不可以使用 <code>yield</code> 命令，因此箭头函数不能用作 Generator 函数</p> <h2 id="_1-7-class"><a href="#_1-7-class" class="header-anchor">#</a> 1.7 Class</h2> <p>ES2015 中的类（class）是在基于原型的面向对象模式上简单包装的语法糖。拥有一个 单一且方便的声明形式将更易于使用，并且 鼓励混合使用。</p> <p>类（class）支持基于原型的<code>继承</code>、<code>super 调用</code>、 <code>实例</code>和<code>静态方法</code>以及<code>构造函数</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ES5写法</span>
<span class="token keyword">function</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'('</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用class改写</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'('</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>注意，定义<code>toString()</code>方法的时候，前面不需要加上<code>function</code>这个关键字，直接把函数定义放进去了就可以了。另外，方法与方法之间不需要逗号分隔，加了会报错。</p></blockquote> <p>类的数据类型就是函数，类本身就指向构造函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">typeof</span> Point <span class="token comment">// &quot;function&quot;</span>
Point <span class="token operator">===</span> <span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token comment">// true</span>
</code></pre></div><p>构造函数的 <code>prototype</code>属性，在 ES6 的“类”上面继续存在。事实上，类的所有方法都定义在类的 <code>prototype</code>属性上面。因此，在类的实例上面调用方法，其实就是调用原型上的方法。</p> <p>另外，类的内部所有定义的方法，都是<code>不可枚举</code>的（non-enumerable）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
 
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token comment">// []</span>
Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token comment">// [&quot;constructor&quot;,&quot;toString&quot;]</span>
</code></pre></div><p>上面代码中，<code>toString()</code>方法是<code>Point</code>类内部定义的方法，它是不可枚举的。这一点与 ES5 的行为不一致。</p> <h2 id="_1-8-字符串"><a href="#_1-8-字符串" class="header-anchor">#</a> 1.8 字符串</h2> <h3 id="_1-8-1-模版字符串"><a href="#_1-8-1-模版字符串" class="header-anchor">#</a> 1.8.1 模版字符串</h3> <p>模板字符串为构造字符串提供了语法糖。</p> <p>模板字符串是增强版的字符串，用反引号（`）标识。它可以当作普通字符串使用，也可以用来定义多行字符串，或者在字符串中嵌入变量。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 普通字符串</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">In JavaScript '\n' is a line-feed.</span><span class="token template-punctuation string">`</span></span>
 
<span class="token comment">// 多行字符串</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">In JavaScript this is
 not legal.</span><span class="token template-punctuation string">`</span></span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">string text line 1
string text line 2</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 字符串中嵌入变量</span>
<span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> time <span class="token operator">=</span> <span class="token string">&quot;today&quot;</span><span class="token punctuation">;</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, how are you </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?</span><span class="token template-punctuation string">`</span></span>
</code></pre></div><p>上面代码中的模板字符串，都是用反引号表示。如果在模板字符串中需要使用反引号，则前面要用反斜杠转义。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> greeting <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\`Yo\` World!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre></div><p>模板字符串中嵌入变量，需要将变量名写在<code>${}</code>之中。这个大括号内部可以放入任意的 JavaScript 表达式，可以进行运算，以及引用对象属性。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
 
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x <span class="token operator">+</span> y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token comment">// &quot;1 + 2 = 3&quot;</span>
 
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y <span class="token operator">*</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x <span class="token operator">+</span> y <span class="token operator">*</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token comment">// &quot;1 + 4 = 5&quot;</span>
 
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>x <span class="token operator">+</span> obj<span class="token punctuation">.</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token comment">// &quot;3&quot;</span>
</code></pre></div><p>模板字符串之中还能调用函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">foo </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bar</span><span class="token template-punctuation string">`</span></span>
<span class="token comment">// foo Hello World bar</span>
</code></pre></div><h3 id="_1-8-2-子串的识别"><a href="#_1-8-2-子串的识别" class="header-anchor">#</a> 1.8.2 子串的识别</h3> <p>ES6 之前判断字符串是否包含子串，用 indexOf 方法，ES6 新增了子串的识别方法，如下：</p> <ul><li><strong>includes()</strong>：返回布尔值，判断是否找到参数字符串。</li> <li><strong>startsWith()</strong>：返回布尔值，判断参数字符串是否在原字符串的头部。</li> <li><strong>endsWith()</strong>：返回布尔值，判断参数字符串是否在原字符串的尾部。</li></ul> <p>以上三个方法都可以接受两个参数，需要搜索的字符串，和可选的搜索起始位置索引。</p> <p>例如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token string">&quot;apple,banana,orange&quot;</span><span class="token punctuation">;</span>
string<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;banana&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// true</span>
string<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// true</span>
string<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// false</span>
string<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;banana&quot;</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>  <span class="token comment">// true</span>
</code></pre></div><p>注意点：</p> <ul><li>这三个方法只返回布尔值，如果需要知道子串的位置，还是得用 indexOf 和 lastIndexOf 。</li> <li>这三个方法如果传入了正则表达式而不是字符串，会抛出错误。而 indexOf 和 lastIndexOf 这两个方法，它们会将正则表达式转换为字符串并搜索它。</li></ul> <h3 id="_1-8-3-repeat"><a href="#_1-8-3-repeat" class="header-anchor">#</a> 1.8.3 repeat()</h3> <p>repeat() 返回新的字符串，表示将字符串重复指定次数返回。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello,&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;Hello,Hello,&quot;</span>
 
<span class="token comment">// 参数如果是小数，则向下取整</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello,&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;Hello,Hello,Hello,&quot;</span>
 
<span class="token comment">// 如果参数是 0 至 -1 之间的小数，会进行取整运算，0 至 -1 之间的小数取整得到 -0 ，等同于 repeat 零次</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello,&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;&quot;</span>
 
<span class="token comment">// 如果参数是 NaN，则 repeat 零次</span>
</code></pre></div><h2 id="_1-9-数值"><a href="#_1-9-数值" class="header-anchor">#</a> 1.9 数值</h2> <h3 id="_1-9-1-number-isfinite"><a href="#_1-9-1-number-isfinite" class="header-anchor">#</a> 1.9.1 Number.isFinite()</h3> <p>该方法用于检查一个数值是否为有限的（ finite ），即不是 Infinity</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> Number<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> Number<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
  
<span class="token comment">// NaN 不是有限的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> Number<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> Number<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> Number<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><h3 id="_1-9-2-number-parseint"><a href="#_1-9-2-number-parseint" class="header-anchor">#</a> 1.9.2 Number.parseInt()</h3> <p>逐步减少全局方法，用于全局变量的模块化。</p> <p>该方法的行为没有发生改变。</p> <h3 id="_1-9-3-math-对象的扩展"><a href="#_1-9-3-math-对象的扩展" class="header-anchor">#</a> 1.9.3 Math 对象的扩展</h3> <p>Math 对象上新增了 17 个数学相关的静态方法，这些方法只能在 Math 对象上调用。</p> <p>详情见：<a href="https://es6.ruanyifeng.com/#docs/number#Math-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%89%A9%E5%B1%95" target="_blank" rel="noopener noreferrer">Math 对象的扩展<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_1-10-对象"><a href="#_1-10-对象" class="header-anchor">#</a> 1.10 对象</h2> <h3 id="_1-10-1-属性的简洁表示法"><a href="#_1-10-1-属性的简洁表示法" class="header-anchor">#</a> 1.10.1 属性的简洁表示法</h3> <p>ES6允许对象的属性直接写变量，这时候属性名是变量名，属性值是变量值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;Amy&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>age<span class="token punctuation">,</span> name<span class="token punctuation">}</span><span class="token punctuation">;</span>
person   <span class="token comment">//{age: 12, name: &quot;Amy&quot;}</span>

<span class="token comment">//等同于</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>age<span class="token operator">:</span> age<span class="token punctuation">,</span> name<span class="token operator">:</span> name<span class="token punctuation">}</span>
</code></pre></div><p>方法名也可以简写：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
person<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;Hi&quot;</span>

<span class="token comment">//等同于</span>
<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">sayHi</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
person<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&quot;Hi&quot;</span>
</code></pre></div><h3 id="_1-10-2-属性名表达式"><a href="#_1-10-2-属性名表达式" class="header-anchor">#</a> 1.10.2 属性名表达式</h3> <p>ES6允许用表达式作为属性名，但是一定要将表达式放在方括号内：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token punctuation">[</span><span class="token string">&quot;he&quot;</span><span class="token operator">+</span><span class="token string">&quot;llo&quot;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token string">&quot;Hi&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;Hi&quot;</span>
</code></pre></div><p>注意点：属性的简洁表示法和属性名表达式不能同时使用，否则会报错。</p> <h3 id="_1-10-3-object-assign-target-source-1-source-2"><a href="#_1-10-3-object-assign-target-source-1-source-2" class="header-anchor">#</a> 1.10.3 Object.assign(target, source_1, source_2, ...)</h3> <p>该方法用于将源对象的所有可枚举属性复制到目标对象中。</p> <p>基本用法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> object2 <span class="token operator">=</span> <span class="token punctuation">{</span>b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> object3 <span class="token operator">=</span> <span class="token punctuation">{</span>c<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>object2<span class="token punctuation">,</span>object3<span class="token punctuation">)</span><span class="token punctuation">;</span> 
 
<span class="token comment">// 第一个参数是目标对象，后面的参数是源对象</span>
target<span class="token punctuation">;</span>  <span class="token comment">// { a: 1, b: 2, c: 3 }</span>
</code></pre></div><ul><li>如果目标对象和源对象有同名属性，或者多个源对象有同名属性，则后面的属性会覆盖前面的属性。</li> <li>如果该函数只有一个参数，当参数为对象时，直接返回该对象；当参数不是对象时，会先将参数转为对象然后返回。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// Number {3}</span>
<span class="token keyword">typeof</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;object&quot;</span>
</code></pre></div><p>但是，因为 null 和 undefined 不能转化为对象，所以会报错。</p> <p>还需要注意，Object.assign() 的属性拷贝是<code>浅拷贝</code>。</p> <h3 id="_1-10-4-object-is-value1-value2"><a href="#_1-10-4-object-is-value1-value2" class="header-anchor">#</a> 1.10.4 Object.is(value1, value2)</h3> <p>用来比较两个值是否严格相等，与（===）基本类似。</p> <p>基本用法：</p> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">&quot;q&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;q&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// true</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// false</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">{</span>q<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>q<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre></div><p>与（===）的区别（<code>弥补 === 的不足点</code>）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//一是+0不等于-0</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>
<span class="token operator">+</span><span class="token number">0</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">0</span>  <span class="token comment">//true</span>
 
<span class="token comment">//二是NaN等于本身</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">,</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
<span class="token number">NaN</span> <span class="token operator">===</span> <span class="token number">NaN</span>  <span class="token comment">//false</span>
</code></pre></div><h2 id="_1-11-数组"><a href="#_1-11-数组" class="header-anchor">#</a> 1.11 数组</h2> <h3 id="_1-11-1-array-of"><a href="#_1-11-1-array-of" class="header-anchor">#</a> 1.11.1 Array.of()</h3> <p>该方法将参数中所有值作为元素形成数组。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4]</span>
  
<span class="token comment">// 参数值可为不同类型</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, '2', true]</span>
  
<span class="token comment">// 参数为空时返回空数组</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span>
</code></pre></div><p>这个方法的主要目的，是<code>弥补数组构造函数 Array() 的不足</code>。因为参数个数的不同，会导致 Array() 的行为有差异：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// []</span>
<span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// [, , ,]</span>
<span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment">// [3, 11, 8]</span>
</code></pre></div><p>上面代码中，Array 方法没有参数、一个参数、三个参数时，返回结果都不一样。只有当参数个数不少于 2 个时，Array() 才会返回由参数组成的新数组。参数个数只有一个时，实际上是指定数组的长度。</p> <h3 id="_1-11-2-array-from-arraylike-mapfn-this"><a href="#_1-11-2-array-from-arraylike-mapfn-this" class="header-anchor">#</a> 1.11.2 Array.from(arrayLike, mapFn, this)</h3> <p>将类数组对象或可迭代对象转化成数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 参数为数组,返回与原数组一样的数组</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2]</span>
  
<span class="token comment">// 参数含空位</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, undefined, 3]</span>
 
<span class="token comment">// 参数为类数组</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">[</span><span class="token punctuation">,</span> mapFn<span class="token punctuation">[</span><span class="token punctuation">,</span> thisArg<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 返回值为转换后的数组</span>
</code></pre></div><p>第二个参数是可选的，为一个 map 函数，用于对每个元素进行处理，放入数组的是处理后的元素：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [2, 4, 6]</span>
</code></pre></div><p>第三个参数是可选的，是一个 this，可指定 map 函数执行时的 this 对象</p> <h4 id="类数组对象"><a href="#类数组对象" class="header-anchor">#</a> 类数组对象</h4> <p>一个类数组对象必须含有 length 属性，且元素属性名必须是数值或者可转换为数值的字符：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token number">0</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  length<span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['1', '2', 3]</span>
  
<span class="token comment">// 没有 length 属性,则返回空数组</span>
<span class="token keyword">let</span> array <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token number">0</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span>
  
<span class="token comment">// 元素属性名不为数值且无法转换为数值，返回长度为 length 元素值为 undefined 的数组 </span>
<span class="token keyword">let</span> array1 <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  length<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [undefined, undefined]</span>
</code></pre></div><h4 id="可迭代对象"><a href="#可迭代对象" class="header-anchor">#</a> 可迭代对象</h4> <p>实现了 Iterator 接口，例如 Map, Set, String：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 转换 Map</span>
<span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'key0'</span><span class="token punctuation">,</span> <span class="token string">'value0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'key1'</span><span class="token punctuation">,</span> <span class="token string">'value1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [['key0', 'value0'],['key1',</span>
<span class="token comment">// 'value1']]</span>
 
<span class="token comment">// 转换 Set</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3]</span>
 
<span class="token comment">// 转换字符串</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'abc'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
</code></pre></div><h3 id="_1-11-3-array-prototype-find"><a href="#_1-11-3-array-prototype-find" class="header-anchor">#</a> 1.11.3 Array.prototype.find()</h3> <p>查找数组中符合条件的元素，若有多个符合条件的元素，则返回第一个元素。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
  
<span class="token comment">// 数组空位处理为 undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre></div><p>find 和 filter 都是不改变原数组的方法，但是 find 只查出第一个符合条件的结果就直接返回，而 filter 则返回全部的结果，且返回结果仍然为数组。</p> <h3 id="_1-11-4-array-prototype-findindex"><a href="#_1-11-4-array-prototype-findindex" class="header-anchor">#</a> 1.11.4 Array.prototype.findIndex()</h3> <p>查找数组中符合条件的元素索引，若有多个符合条件的元素，则返回第一个元素索引。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 参数1：回调函数</span>
<span class="token comment">// 参数2(可选)：指定回调函数中的 this 值</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
  
<span class="token comment">// 数组空位处理为 undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>
</code></pre></div><h3 id="_1-11-5-array-prototype-fill"><a href="#_1-11-5-array-prototype-fill" class="header-anchor">#</a> 1.11.5 Array.prototype.fill()</h3> <p>将一定范围索引的数组元素内容填充为单个指定的值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 参数1：用来填充的值</span>
<span class="token comment">// 参数2：被填充的起始索引</span>
<span class="token comment">// 参数3(可选)：被填充的结束索引，默认为数组末尾</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 0, 3, 4]</span>
</code></pre></div><h3 id="_1-11-6-array-prototype-copywithin"><a href="#_1-11-6-array-prototype-copywithin" class="header-anchor">#</a> 1.11.6 Array.prototype.copyWithin()</h3> <p>将一定范围索引的数组元素修改为此数组另一指定范围索引的元素。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 参数1：被修改的起始索引</span>
<span class="token comment">// 参数2：被用来覆盖的数据的起始索引</span>
<span class="token comment">// 参数3(可选)：被用来覆盖的数据的结束索引，默认为数组末尾</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [3, 4, 3, 4]</span>
  
<span class="token comment">// 参数1为负数表示倒数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 1, 2]</span>
  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [, 4, , 4]</span>
</code></pre></div><h3 id="_1-11-7-实例方法-entries-keys-和-values"><a href="#_1-11-7-实例方法-entries-keys-和-values" class="header-anchor">#</a> 1.11.7 实例方法 entries(), keys() 和 values()</h3> <p>ES6 提供三个新的方法—— entries()，keys() 和 values() ——用于遍历数组。它们都返回一个遍历器对象，可以用 for...of 循环进行遍历，唯一的区别是 keys() 是对键名的遍历、values() 是对键值的遍历，entries() 是对键值对的遍历。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token keyword">of</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 0</span>
<span class="token comment">// 1</span>
 
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> elem <span class="token keyword">of</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 'a'</span>
<span class="token comment">// 'b'</span>
 
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>index<span class="token punctuation">,</span> elem<span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 0 &quot;a&quot;</span>
<span class="token comment">// 1 &quot;b&quot;</span>
</code></pre></div><h2 id="_1-12-迭代器"><a href="#_1-12-迭代器" class="header-anchor">#</a> 1.12 迭代器</h2> <p>Iterator 是 ES6 引入的一种新的遍历机制，迭代器有两个核心概念：</p> <ul><li>迭代器是一个统一的接口，它的作用是使各种数据结构可被便捷的访问，它是通过一个键为 Symbol.iterator 的方法来实现</li> <li>迭代器是用于遍历数据结构元素的指针（如数据库中的游标）</li></ul> <p>迭代的过程如下：</p> <ul><li>通过 Symbol.iterator 创建一个迭代器，指向当前数据结构的起始位置</li> <li>随后通过 next 方法进行向下迭代指向下一个位置， next 方法会返回当前位置的对象，对象包含了 value 和 done 两个属性， value 是当前属性的值， done 用于判断是否遍历结束</li> <li>当 done 为 true 时则遍历结束</li></ul> <p>例如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;zero&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> it <span class="token operator">=</span> items<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span><span class="token punctuation">{</span>value<span class="token operator">:</span> <span class="token string">&quot;zero&quot;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span><span class="token punctuation">{</span>value<span class="token operator">:</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span><span class="token punctuation">{</span>value<span class="token operator">:</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span><span class="token punctuation">{</span>value<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
</code></pre></div><p>可迭代的数据结构有：Array（arguments 也可遍历）, String, Map, Set，我们可以使用 for...of 循环来对这些数据结构进行迭代。</p> <h2 id="_1-13-模块"><a href="#_1-13-模块" class="header-anchor">#</a> 1.13 模块</h2> <p>ES6 的模块自动开启严格模式，不管你有没有在模块头部加上 use strict。</p> <p>模块中可以导入和导出各种类型的变量，如函数，对象，字符串，数字，布尔值，类等。</p> <p>每个模块都有自己的上下文，每一个模块内声明的变量都是局部变量，不会污染全局作用域。</p> <p>每一个模块只加载一次（是单例的）， 若再去加载同目录下同文件，直接从内存中读取。</p> <h3 id="_1-13-1-export-与-import"><a href="#_1-13-1-export-与-import" class="header-anchor">#</a> 1.13.1 export 与 import</h3> <p>模块导入导出各种类型的变量，如字符串，数值，函数，类。</p> <ul><li>导出的函数声明与类声明必须要有名称（export default 命令另外考虑）。</li> <li>不仅能导出声明还能导出引用（例如函数）。</li> <li>export 命令可以出现在模块的任何位置，但必需处于模块顶层。</li> <li>import 命令会提升到整个模块的头部，首先执行。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*-----export [test.js]-----*/</span>
<span class="token keyword">let</span> myName <span class="token operator">=</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myAge <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">myfn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;My name is&quot;</span> <span class="token operator">+</span> myName <span class="token operator">+</span> <span class="token string">&quot;! I'm '&quot;</span> <span class="token operator">+</span> myAge <span class="token operator">+</span> <span class="token string">&quot;years old.&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> myClass <span class="token operator">=</span>  <span class="token keyword">class</span> <span class="token class-name">myClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> a <span class="token operator">=</span> <span class="token string">&quot;yeah!&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> myName<span class="token punctuation">,</span> myAge<span class="token punctuation">,</span> myfn<span class="token punctuation">,</span> myClass <span class="token punctuation">}</span>
  
<span class="token comment">/*-----import [xxx.js]-----*/</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> myName<span class="token punctuation">,</span> myAge<span class="token punctuation">,</span> myfn<span class="token punctuation">,</span> myClass <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./test.js&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">myfn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// My name is Tom! I'm 20 years old.</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myAge<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 20</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Tom</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myClass<span class="token punctuation">.</span>a <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// yeah!</span>
</code></pre></div><p>建议使用大括号指定所要输出的一组变量写在文档尾部，明确导出的接口。</p> <p>函数与类都需要有对应的名称。</p> <h3 id="_1-13-2-as-的用法"><a href="#_1-13-2-as-的用法" class="header-anchor">#</a> 1.13.2 as 的用法</h3> <p>export 命令导出的接口名称，须和模块内部的变量有一一对应关系。导入的变量名，须和导出的接口名称相同，即顺序可以不一致。</p> <p>不同模块导出接口名称命名重复时，可使用 as 重新定义变量名。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*-----export [test.js]-----*/</span>
<span class="token keyword">let</span> myName <span class="token operator">=</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> myName <span class="token keyword">as</span> exportName <span class="token punctuation">}</span>
  
<span class="token comment">/*-----import [xxx.js]-----*/</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> exportName <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./test.js&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>exportName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Tom</span>
使用 <span class="token keyword">as</span> 重新定义导出的接口名称，隐藏模块内部的变量
<span class="token comment">/*-----export [test1.js]-----*/</span>
<span class="token keyword">let</span> myName <span class="token operator">=</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> myName <span class="token punctuation">}</span>
<span class="token comment">/*-----export [test2.js]-----*/</span>
<span class="token keyword">let</span> myName <span class="token operator">=</span> <span class="token string">&quot;Jerry&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> myName <span class="token punctuation">}</span>
<span class="token comment">/*-----import [xxx.js]-----*/</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> myName <span class="token keyword">as</span> name1 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./test1.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> myName <span class="token keyword">as</span> name2 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./test2.js&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Tom</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Jerry</span>
</code></pre></div><h3 id="_1-13-3-import-命令的特点"><a href="#_1-13-3-import-命令的特点" class="header-anchor">#</a> 1.13.3 import 命令的特点</h3> <p>只读属性：不允许在加载模块的脚本里面，改写接口的引用指向，即可以改写 import 变量类型为对象的属性值，不能改写 import 变量类型为基本类型的值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>a<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./xxx.js&quot;</span>
a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// error</span>
  
<span class="token keyword">import</span> <span class="token punctuation">{</span>a<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./xxx.js&quot;</span>
a<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span> <span class="token comment">// a = { foo : 'hello' }</span>
</code></pre></div><p>单例模式：多次重复执行同一句 import 语句，那么只会执行一次，而不会执行多次。import 同一模块，声明不同接口引用，会声明对应变量，但只执行一次 import 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token string">&quot;./xxx.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token string">&quot;./xxx.js&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 相当于 import { a } &quot;./xxx.js&quot;;</span>
  
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./xxx.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./xxx.js&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 相当于 import { a, b } from &quot;./xxx.js&quot;;</span>
</code></pre></div><p>静态执行特性：import 是静态执行，所以不能使用表达式和变量。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token string">&quot;f&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;oo&quot;</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;methods&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// error</span>
<span class="token keyword">let</span> module <span class="token operator">=</span> <span class="token string">&quot;methods&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> module<span class="token punctuation">;</span>
<span class="token comment">// error</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;method1&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;method2&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// error</span>
</code></pre></div><h3 id="_1-13-4-export-default-命令"><a href="#_1-13-4-export-default-命令" class="header-anchor">#</a> 1.13.4 export default 命令</h3> <ul><li>在一个文件或模块中，export、import 可以有多个，export default 仅有一个。</li> <li>export default 中的 default 是对应的导出接口变量。</li> <li>通过 export 方式导出，在导入时要加{ }，export default 则不需要。</li> <li>export default 向外暴露的成员，可以使用任意变量来接收。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;My name is Tom!&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> a<span class="token punctuation">;</span> <span class="token comment">// 仅有一个</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// error，default 已经是对应的导出变量，不能跟着变量声明语句</span>
  
<span class="token keyword">import</span> b <span class="token keyword">from</span> <span class="token string">&quot;./xxx.js&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 不需要加{}， 使用任意变量接收</span>
</code></pre></div><h2 id="_1-14-proxy"><a href="#_1-14-proxy" class="header-anchor">#</a> 1.14 Proxy</h2> <p>Proxy 可以对目标对象的读取、函数调用等操作进行拦截，然后进行操作处理。它不直接操作对象，而是像代理模式，通过对象的代理对象进行操作，在进行这些操作时，可以添加一些需要的额外操作。</p> <p>基本用法：</p> <p>一个 Proxy 对象由两个部分组成： target 、 handler 。</p> <p>在通过 Proxy 构造函数生成实例对象时，需要提供这两个参数。 target 即目标对象， handler 是一个对象，声明了代理 target 的指定行为。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">24</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'getting '</span><span class="token operator">+</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 不是target.key</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setting '</span><span class="token operator">+</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
proxy<span class="token punctuation">.</span>name     <span class="token comment">// 实际执行 handler.get</span>
proxy<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">25</span> <span class="token comment">// 实际执行 handler.set</span>
<span class="token comment">// getting name</span>
<span class="token comment">// setting age</span>
<span class="token comment">// 25</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// target 可以为空对象</span>
<span class="token keyword">let</span> targetEpt <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> proxyEpt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>targetEpt<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token comment">// 调用 get 方法，此时目标对象为空，没有 name 属性</span>
proxyEpt<span class="token punctuation">.</span>name <span class="token comment">// getting name</span>
<span class="token comment">// 调用 set 方法，向目标对象中添加了 name 属性</span>
proxyEpt<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Tom'</span>
<span class="token comment">// setting name</span>
<span class="token comment">// &quot;Tom&quot;</span>
<span class="token comment">// 再次调用 get ，此时已经存在 name 属性</span>
proxyEpt<span class="token punctuation">.</span>name
<span class="token comment">// getting name</span>
<span class="token comment">// &quot;Tom&quot;</span>
  
<span class="token comment">// 通过构造函数新建实例时其实是对目标对象进行了浅拷贝，因此目标对象与代理对象会互相</span>
<span class="token comment">// 影响</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>targetEpt<span class="token punctuation">)</span>
<span class="token comment">// {name: &quot;Tom&quot;}</span>
  
<span class="token comment">// handler 对象也可以为空，相当于不设置拦截操作，直接访问目标对象</span>
<span class="token keyword">let</span> targetEmpty <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> proxyEmpty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>targetEmpty<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
proxyEmpty<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Tom&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>targetEmpty<span class="token punctuation">)</span> <span class="token comment">// {name: &quot;Tom&quot;}</span>
</code></pre></div><h3 id="_1-14-1-get-target-propkey-receiver"><a href="#_1-14-1-get-target-propkey-receiver" class="header-anchor">#</a> 1.14.1 get(target, propKey, receiver)</h3> <p>用于 target 对象上 propKey 的读取操作。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> exam <span class="token operator">=</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">24</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Getting '</span> <span class="token operator">+</span> propKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>propKey<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
proxy<span class="token punctuation">.</span>name
<span class="token comment">// Getting name</span>
<span class="token comment">// &quot;Tom&quot;</span>
</code></pre></div><p>get() 方法可以继承：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 实现私有属性读取保护</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>propKey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Erro</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Invalid attempt to get private     &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>propKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Getting '</span> <span class="token operator">+</span> propKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> target<span class="token punctuation">[</span>propKey<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>name
<span class="token comment">// Getting name</span>
</code></pre></div><h3 id="_1-14-2-set-target-propkey-value-receiver"><a href="#_1-14-2-set-target-propkey-value-receiver" class="header-anchor">#</a> 1.14.2 set(target, propKey, value, receiver)</h3> <p>用于拦截 target 对象上的 propKey 的赋值操作。如果目标对象自身的某个属性，不可写且不可配置，那么set方法将不起作用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> validator <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>prop <span class="token operator">===</span> <span class="token string">'age'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'The age is not an integer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RangeError</span><span class="token punctuation">(</span><span class="token string">'The age seems invalid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 对于满足条件的 age 属性以及其他属性，直接保存</span>
        obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> proxy<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> validator<span class="token punctuation">)</span>
proxy<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
proxy<span class="token punctuation">.</span>age           <span class="token comment">// 100</span>
proxy<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token string">'oppps'</span> <span class="token comment">// 报错</span>
proxy<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">300</span>     <span class="token comment">// 报错</span>
</code></pre></div><p>第四个参数 receiver 表示原始操作行为所在对象，一般是 Proxy 实例本身。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> receiver<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
proxy<span class="token punctuation">.</span>name<span class="token operator">=</span> <span class="token string">'Tom'</span><span class="token punctuation">;</span>
proxy<span class="token punctuation">.</span>name<span class="token operator">===</span> proxy <span class="token comment">// true</span>
  
<span class="token keyword">const</span> exam <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> proxy<span class="token punctuation">)</span>
exam<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Tom&quot;</span>
exam<span class="token punctuation">.</span>name <span class="token operator">===</span> exam <span class="token comment">// true</span>
</code></pre></div><p>注意，严格模式下，set代理如果没有返回true，就会报错。</p> <h3 id="_1-14-3-apply-target-ctx-args"><a href="#_1-14-3-apply-target-ctx-args" class="header-anchor">#</a> 1.14.3 apply(target, ctx, args)</h3> <p>用于拦截函数的调用、call 和 reply 操作。target 表示目标对象，ctx 表示目标对象上下文，args 表示目标对象的参数数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">apply</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'handle apply'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">Reflect</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>sub<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token function">proxy</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// handle apply</span>
<span class="token comment">// 1</span>
</code></pre></div><p>还有更多的操作方法，详情见：<a href="https://es6.ruanyifeng.com/#docs/proxy#Proxy-%E5%AE%9E%E4%BE%8B%E7%9A%84%E6%96%B9%E6%B3%95" target="_blank" rel="noopener noreferrer">Proxy 实例方法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_1-15-reflect"><a href="#_1-15-reflect" class="header-anchor">#</a> 1.15 Reflect</h2> <p>ES6 中将 Object 的一些明显属于语言内部的方法移植到了 Reflect 对象上（当前某些方法会同时存在于 Object 和 Reflect 对象上），未来的新方法会只部署在 Reflect 对象上。</p> <p>Reflect 对象对某些方法的返回结果进行了修改，使其更合理。</p> <p>Reflect 对象使用函数的方式实现了 Object 的命令式操作。</p> <h3 id="_1-15-1-reflect-get-target-name-receiver"><a href="#_1-15-1-reflect-get-target-name-receiver" class="header-anchor">#</a> 1.15.1 Reflect.get(target, name, receiver)</h3> <p>查找并返回 target 对象的 name 属性。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> exam <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Tom&quot;</span>
  
<span class="token comment">// 当 target 对象中存在 name 属性的 getter 方法， getter 方法的 this 会绑定 // receiver</span>
<span class="token keyword">let</span> receiver <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Jerry&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">20</span>
<span class="token punctuation">}</span>
Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'info'</span><span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Jerry20</span>
  
<span class="token comment">// 当 name 为不存在于 target 对象的属性时，返回 undefined</span>
Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'birth'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
  
<span class="token comment">// 当 target 不是对象时，会报错</span>
Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypeError</span>
</code></pre></div><h3 id="_1-15-2-reflect-set-target-name-value-receiver"><a href="#_1-15-2-reflect-set-target-name-value-receiver" class="header-anchor">#</a> 1.15.2 Reflect.set(target, name, value, receiver)</h3> <p>将 target 的 name 属性设置为 value。返回值为 boolean ，true 表示修改成功，false 表示失败。当 target 为不存在的对象时，会报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> exam <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
exam<span class="token punctuation">.</span>age<span class="token punctuation">;</span> <span class="token comment">// 24</span>
Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
exam<span class="token punctuation">.</span>age<span class="token punctuation">;</span> <span class="token comment">// 25</span>
  
<span class="token comment">// value 为空时会将 name 属性清除</span>
Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
exam<span class="token punctuation">.</span>age<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
  
<span class="token comment">// 当 target 对象中存在 name 属性 setter 方法时，setter 方法中的 this 会绑定 // receiver , 所以修改的实际上是 receiver 的属性,</span>
<span class="token keyword">let</span> receiver <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span>
Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
receiver<span class="token punctuation">.</span>age<span class="token punctuation">;</span> <span class="token comment">// 1</span>
  
<span class="token keyword">let</span> receiver1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'oppps'</span>
<span class="token punctuation">}</span>
Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> receiver1<span class="token punctuation">)</span><span class="token punctuation">;</span>
receiver1<span class="token punctuation">.</span>age<span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre></div><h3 id="_1-15-3-reflect-has-obj-name"><a href="#_1-15-3-reflect-has-obj-name" class="header-anchor">#</a> 1.15.3 Reflect.has(obj, name)</h3> <p>是 name in obj 指令的函数化，用于查找 name 属性在 obj 对象中是否存在。返回值为 boolean。如果 obj 不是对象则会报错 TypeError。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> exam <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">24</span>
<span class="token punctuation">}</span>
Reflect<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>exam<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>还有更多的操作方法，详情见：<a href="https://es6.ruanyifeng.com/#docs/reflect#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95" target="_blank" rel="noopener noreferrer">Reflect 静态方法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_1-16-promise-对象"><a href="#_1-16-promise-对象" class="header-anchor">#</a> 1.16 Promise 对象</h2> <p>Promise 是异步编程的一种解决方案。</p> <p>从语法上说，Promise 是一个对象，从它可以获取异步操作的消息。</p> <h3 id="_1-16-1-promise-状态"><a href="#_1-16-1-promise-状态" class="header-anchor">#</a> 1.16.1 Promise 状态</h3> <p>Promise 异步操作有三种状态：pending（进行中）、fulfilled（已成功）和 rejected（已失败）。除了异步操作的结果，任何其他操作都无法改变这个状态。</p> <p>Promise 对象只有：从 pending 变为 fulfilled 和从 pending 变为 rejected 的状态改变。只要处于 fulfilled 和 rejected ，状态就不会再变了即 resolved（已定型）。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'success1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'success2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'success3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'reject'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// success1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p2<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// success3</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>状态的缺点有：</p> <ul><li>无法取消 Promise ，一旦新建它就会立即执行，无法中途取消。</li> <li>如果不设置回调函数，Promise 内部抛出的错误，不会反应到外部。</li> <li>当处于 pending 状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）。</li></ul> <h3 id="_1-16-2-then-方法"><a href="#_1-16-2-then-方法" class="header-anchor">#</a> 1.16.2 then 方法</h3> <p>then 方法接收两个函数作为参数，第一个参数是 Promise 执行成功时的回调，第二个参数是 Promise 执行失败时的回调，两个函数只会有一个被调用。</p> <p>在 JavaScript 事件队列的当前运行完成之前，回调函数永远不会被调用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'first'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// first</span>
<span class="token comment">// success</span>
</code></pre></div><p>then 方法将返回一个 resolved 或 rejected 状态的 Promise 对象用于链式调用，且 Promise 对象的值就是这个返回值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 第一个then // 1</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> value <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 第二个then // 2</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 第三个then // undefined</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'resolve'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 第四个then // resolve</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'reject'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 第五个then //reject:reject</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'resolve:'</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reject:'</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_1-17-generator-函数"><a href="#_1-17-generator-函数" class="header-anchor">#</a> 1.17 Generator 函数</h2> <p>ES6 新引入了 Generator 函数，可以通过 yield 关键字，把函数的执行流挂起，为改变执行流程提供了可能，从而为异步编程提供解决方案。</p> <p>详情见：<a href="https://es6.ruanyifeng.com/#docs/generator" target="_blank" rel="noopener noreferrer">Generator 函数的语法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="二、es2016"><a href="#二、es2016" class="header-anchor">#</a> 二、ES2016</h1> <h2 id="_2-1-array-prototype-includes"><a href="#_2-1-array-prototype-includes" class="header-anchor">#</a> 2.1 Array.prototype.includes()</h2> <p>includes() 方法用来判断一个数组是否包含一个特定的值，如果包含则返回 true，否则返回 false</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> array1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array1<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// true</span>
 
<span class="token keyword">const</span> pets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'bat'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pets<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'cat'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// true</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pets<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'at'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// false</span>
</code></pre></div><h2 id="_2-2-求幂运算符"><a href="#_2-2-求幂运算符" class="header-anchor">#</a> 2.2 求幂运算符</h2> <p>新增了一个求幂运算符 **，等价于 Math.pow()</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
 
<span class="token comment">// 右结合，从右至左计算</span>
<span class="token number">2</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// 256</span>
 
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
a <span class="token operator">**=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">// 等价于 a = a * a;</span>
 
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
b <span class="token operator">**=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">// 等价于 b = b * b * b;</span>
</code></pre></div><h1 id="三、es2017"><a href="#三、es2017" class="header-anchor">#</a> 三、ES2017</h1> <h2 id="_3-1-字符串补全"><a href="#_3-1-字符串补全" class="header-anchor">#</a> 3.1 字符串补全</h2> <ul><li><strong>padStart</strong>：返回新的字符串，表示用参数字符串从头部（左侧）补全原字符串。</li> <li><strong>padEnd</strong>：返回新的字符串，表示用参数字符串从尾部（右侧）补全原字符串。</li></ul> <p>以上两个方法接受两个参数，第一个参数是指定生成的字符串的最小长度，第二个参数是用来补全的字符串。如果没有指定第二个参数，默认用空格填充。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">&quot;o&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;ooooh&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">.</span><span class="token function">padEnd</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">&quot;o&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// &quot;hoooo&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// &quot;    h&quot;</span>
</code></pre></div><h2 id="_3-2-object-values"><a href="#_3-2-object-values" class="header-anchor">#</a> 3.2 Object.values()</h2> <p>该方法返回一个包含所有对象自身属性值的数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Fred'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">87</span> <span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span> <span class="token comment">// ['Fred', 87]</span>
</code></pre></div><p>同样的，也适用于数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Fred'</span><span class="token punctuation">,</span> <span class="token string">'Tony'</span><span class="token punctuation">]</span> 
Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>people<span class="token punctuation">)</span> <span class="token comment">// ['Fred', 'Tony']</span>
</code></pre></div><h2 id="_3-3-object-entries"><a href="#_3-3-object-entries" class="header-anchor">#</a> 3.3 Object.entries()</h2> <p>该方法返回一个包含所有对象自身属性的数组，作为[key, value] 对</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Fred'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">87</span> <span class="token punctuation">}</span> 
Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span> <span class="token comment">// [['name', 'Fred'], ['age', 87]]</span>
</code></pre></div><p>同样的，也适用于数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Fred'</span><span class="token punctuation">,</span> <span class="token string">'Tony'</span><span class="token punctuation">]</span> 
Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>people<span class="token punctuation">)</span> <span class="token comment">// [['0', 'Fred'], ['1', 'Tony']]</span>
</code></pre></div><h2 id="_3-4-object-getownpropertydescriptors"><a href="#_3-4-object-getownpropertydescriptors" class="header-anchor">#</a> 3.4 Object.getOwnPropertyDescriptors()</h2> <p>此方法返回对象的所有自有（非继承的）属性描述符。</p> <p>描述符是属性（property）的一组特性（attributes），它由以下的子集组成：</p> <ul><li><strong>value</strong>：属性的值</li> <li><strong>writable</strong>：<code>true</code> 表示改属性可以被修改</li> <li><strong>get</strong>：属性的 getter 函数，在读取属性时调用</li> <li><strong>set</strong>：属性的 setter 函数，在属性设置值时调用</li> <li><strong>configurable</strong>：如果为 <code>false</code> ，则不能删除属性，也不能更改任何属性，但值除外</li> <li><strong>enumerable</strong>：如果属性是可枚举的，则为 <code>true</code></li></ul> <p>Object.getOwnPropertyDescriptors() 接收一个对象，并返回一个带有描述符集的对象</p> <h2 id="_3-5-函数参数列表中和函数调用中的尾随逗号"><a href="#_3-5-函数参数列表中和函数调用中的尾随逗号" class="header-anchor">#</a> 3.5 函数参数列表中和函数调用中的尾随逗号</h2> <p>此功能允许在函数声明和函数调用中使用尾随逗号：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">doSomething</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
<span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token string">'test2'</span><span class="token punctuation">,</span> <span class="token string">'test2'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_3-6-async-函数"><a href="#_3-6-async-函数" class="header-anchor">#</a> 3.6 Async 函数</h2> <p>引入了 Async Functions (异步函数) 的概念，这是 ECMAScript 版本中引入的最重要的变化。</p> <h2 id="_3-7-共享内存-sharedarraybuffer-和-atomics"><a href="#_3-7-共享内存-sharedarraybuffer-和-atomics" class="header-anchor">#</a> 3.7 共享内存（SharedArrayBuffer）和 Atomics</h2> <p>WebWorkers 用于在浏览器中创建多线程程序。</p> <p>从ES2017开始，你可以使用 SharedArrayBuffer 在 Web worker 及其创建者之间创建共享内存数组。</p> <p>详情见：<a href="https://www.html.cn/archives/7724" target="_blank" rel="noopener noreferrer">共享内存和 Atomics<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="四、es2018"><a href="#四、es2018" class="header-anchor">#</a> 四、ES2018</h1> <h2 id="_4-1-展开运算符"><a href="#_4-1-展开运算符" class="header-anchor">#</a> 4.1 展开运算符（...）</h2> <p>展开语法, 可以在函数调用/数组构造时, 将数组表达式或者字符串在语法层面展开；还可以在构造字面量对象时, 将对象表达式按 key-value 的方式展开：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token operator">...</span>numbers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// expected output: 700</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span>numbers<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// expected ouput: Object { 0: 100, 1: 200, 2: 400 }</span>
<span class="token comment">// expected output: 6</span>
</code></pre></div><h2 id="_4-2-asynchronous-iteration-异步迭代"><a href="#_4-2-asynchronous-iteration-异步迭代" class="header-anchor">#</a> 4.2 Asynchronous iteration（异步迭代）</h2> <p>for await…of 语句会在异步或者同步可迭代对象上创建一个迭代循环，包括 String，Array，Array-like 对象（比如arguments 或者NodeList)，TypedArray，Map， Set和自定义的异步或者同步可迭代对象。</p> <p>其会调用自定义迭代钩子，并为每个不同属性的值执行语句。下面是迭代异步生成器的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">asyncGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span>num <span class="token keyword">of</span> <span class="token function">asyncGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 0</span>
<span class="token comment">// 1</span>
<span class="token comment">// 2</span>
</code></pre></div><h2 id="_4-3-promise-prototype-finally"><a href="#_4-3-promise-prototype-finally" class="header-anchor">#</a> 4.3 Promise.prototype.finally</h2> <p>当一个 promise 得到满足（fulfilled）时，它会一个接一个的调用 then() 方法；如果在此期间发生错误，则跳过 then() 方法执行 catch() 方法</p> <p>finally() 则允许你运行一些代码，不论 promise 执行成功还是失败</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'file.json'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_4-4-正则表达式改进"><a href="#_4-4-正则表达式改进" class="header-anchor">#</a> 4.4 正则表达式改进</h2> <h3 id="_4-4-1-lookahead-先行断言-和-lookbehind-后行断言"><a href="#_4-4-1-lookahead-先行断言-和-lookbehind-后行断言" class="header-anchor">#</a> 4.4.1 lookahead（先行断言）和 lookbehind（后行断言）</h3> <p>先行断言(lookahead)使用 ?= 符号，是已有的功能。</p> <p>下面是一个先行断言(lookahead)：你可以使用 ?= 匹配一个字符串，该字符串后面跟着一个特定的子字符串：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Roger(?=Waters)</span><span class="token regex-delimiter">/</span></span>
  
<span class="token operator">/</span><span class="token function">Roger</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span> Waters<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Roger is my dog'</span><span class="token punctuation">)</span> <span class="token comment">//false</span>
<span class="token operator">/</span><span class="token function">Roger</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span> Waters<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Roger is my dog and Roger Waters is a famous musician'</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
</code></pre></div><p>?! 执行逆操作，匹配一个字符串，该字符串后面没有一个特定的子字符串：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Roger(?!Waters)</span><span class="token regex-delimiter">/</span></span>
  
<span class="token operator">/</span><span class="token function">Roger</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span> Waters<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Roger is my dog'</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
<span class="token operator">/</span><span class="token function">Roger</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span> Waters<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Roger Waters is a famous musician'</span><span class="token punctuation">)</span> <span class="token comment">//false</span>
</code></pre></div><p>后行断言(lookbehind) 逆操作，是一个新功能，使用 ?&lt; !</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;!Roger) Waters</span><span class="token regex-delimiter">/</span></span>
  
<span class="token operator">/</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">!</span>Roger<span class="token punctuation">)</span> Waters<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Pink Waters is my dog'</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
<span class="token operator">/</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">!</span>Roger<span class="token punctuation">)</span> Waters<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Roger is my dog and Roger Waters is a famous musician'</span><span class="token punctuation">)</span> <span class="token comment">//false</span>
</code></pre></div><h3 id="_4-4-2-unicode-属性转义-p-和-p"><a href="#_4-4-2-unicode-属性转义-p-和-p" class="header-anchor">#</a> 4.4.2 Unicode 属性转义 \p{...} 和 \P{...}</h3> <p>在正则表达式模式中，您可以使用 \d 匹配任何数字，\s 匹配任何不为空格的字符，\w 匹配任何字母数字字符，依此类推。</p> <p>这个新功能将扩展此概念到引入 \p{} 匹配所有 Unicode 字符，否定为 \P{} 。</p> <h3 id="_4-4-3-命名捕获组"><a href="#_4-4-3-命名捕获组" class="header-anchor">#</a> 4.4.3 命名捕获组</h3> <p>在 ES2018 中，可以为捕获组分配一个名称，而不是仅在结果数组中分配一个 slot（插槽）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;year&gt;\d{4})-(?&lt;month&gt;\d{2})-(?&lt;day&gt;\d{2})</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">const</span> result <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'2015-01-02'</span><span class="token punctuation">)</span>
  
<span class="token comment">// result.groups.year === '2015';</span>
<span class="token comment">// result.groups.month === '01';</span>
<span class="token comment">// result.groups.day === '02';</span>
</code></pre></div><h3 id="_4-4-4-正则表达式的-s-标志"><a href="#_4-4-4-正则表达式的-s-标志" class="header-anchor">#</a> 4.4.4 正则表达式的 s 标志</h3> <p>s 标志是 ‘single line'(单行)的缩写，它使(.)匹配新的行字符。如果没有它，(.)将匹配普通字符，而不是新行：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">hi.welcome</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'hi\nwelcome'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span>hi<span class="token punctuation">.</span>welcome<span class="token operator">/</span>s<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'hi\nwelcome'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><h1 id="五、es2019"><a href="#五、es2019" class="header-anchor">#</a> 五、ES2019</h1> <h2 id="_5-1-string-prototype-trimstart-和-string-prototype-trimend"><a href="#_5-1-string-prototype-trimstart-和-string-prototype-trimend" class="header-anchor">#</a> 5.1 String.prototype.trimStart() 和 String.prototype.trimEnd()</h2> <p>在接收用户输入的文本时，我们经常使用 String.prototype.trim() 来去除首尾的空格、换行符等。</p> <p>现在可以通过 trimStart() 和 trimEnd() 来进行首尾的单独去除。trimLeft() 和 trimRight() 是他们的别名。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> string <span class="token operator">=</span> <span class="token string">' Hello ES2021! '</span><span class="token punctuation">;</span>

string<span class="token punctuation">.</span><span class="token function">trimStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 'Hello ES2021! '</span>
string<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ' Hello ES2021!'</span>
</code></pre></div><h2 id="_5-2-object-fromentries"><a href="#_5-2-object-fromentries" class="header-anchor">#</a> 5.2 Object.fromEntries()</h2> <p>ES2017 为我们引入了 Object.entries，可以把一个对象转为 [key, value] 键值对的形式，可以运用于像 Map 这种结构中。</p> <p>ES2019 的 Object.fromEntries() 则用于把键值对还原成对象结构。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> entries <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> object <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { foo: 'bar' }</span>
</code></pre></div><h2 id="_5-3-array-prototype-flat-和-array-prototype-flatmap"><a href="#_5-3-array-prototype-flat-和-array-prototype-flatmap" class="header-anchor">#</a> 5.3 Array.prototype.flat() 和 Array.prototype.flatMap()</h2> <p>这两个方法用于将数组展平，通过传入层级深度作为参数（默认为1），来为下层的数组提升层级：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [ 1, 2, 3, 4 ]</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [ 1, 2, 3, 4, 5, 6 ]</span>
</code></pre></div><p>Array.prototype.flatMap() 是 Array.prototype.map() 和 Array.prototype.flat() 的组合，通过对 map 调整后的数据尝试展平操作：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> v <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v <span class="token operator">*</span> <span class="token number">2</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// [2, 4, 6, 8]</span>
</code></pre></div><h2 id="_5-4-catch-的参数改为可选"><a href="#_5-4-catch-的参数改为可选" class="header-anchor">#</a> 5.4 catch 的参数改为可选</h2> <p>之前，在进行 try...catch 错误处理过程中，如果没有给 catch 传参数的话，代码就会报错。</p> <p>而有时候我们并不关心错误情况，如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">isValidJSON</span> <span class="token operator">=</span> <span class="token parameter">json</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>unusedError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Unused error parameter</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>在 ES2019 后，我们则可以省略 catch 绑定的参数和括号：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">isValidJSON</span> <span class="token operator">=</span> <span class="token parameter">json</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_5-5-symbol-prototype-description"><a href="#_5-5-symbol-prototype-description" class="header-anchor">#</a> 5.5 Symbol.prototype.description</h2> <p>Symbol 是 ES6 中引入的基本数据类型，可以用作对象属性的标识符。</p> <p>描述属性是只读的，可用于获取符号对象的描述，更好了解它的作用。例如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> symbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'This is a Symbol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
symbol<span class="token punctuation">;</span>
<span class="token comment">// Symbol(This is a Symbol)</span>
Symbol<span class="token punctuation">.</span>description<span class="token punctuation">;</span>
<span class="token comment">// 'This is a Symbol'</span>
</code></pre></div><h2 id="_5-6-json-superset-超集"><a href="#_5-6-json-superset-超集" class="header-anchor">#</a> 5.6 JSON superset（超集）</h2> <p>在之前，如果JSON字符串中包含有行分隔符(\u2028) 和段落分隔符(\u2029)，那么在解析过程中会报错：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'&quot;\u2028&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// SyntaxError</span>
</code></pre></div><p>现在ES2019对它们提供了支持：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'&quot;\u2028&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// ''</span>
</code></pre></div><h2 id="_5-7-json-stringify"><a href="#_5-7-json-stringify" class="header-anchor">#</a> 5.7 JSON.stringify</h2> <p>一些表情的字符，例如'\uD83D'，会被认为这是一个无效的文本字符串。在早期版本中，这些字符将替换为特殊字符：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">'\uD83D'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// '&quot;�&quot;'</span>
</code></pre></div><p>现在在字符代码之前插入转义字符，结果仍是可读且有效的UTF-8/UTF-16代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">'\uD83D'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// '&quot;\\ud83d&quot;'</span>
</code></pre></div><h2 id="_5-8-array-prototype-sort-变得更加稳定"><a href="#_5-8-array-prototype-sort-变得更加稳定" class="header-anchor">#</a> 5.8 Array.prototype.sort() 变得更加稳定</h2> <p>在之前，规范中不允许不稳定的排序算法，例如快速排序：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>a<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>a <span class="token operator">-</span> b<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [{a: 1, b: 2}, {a: 1, b: 3}...] / [{a: 1, b: 3}, {a: 1, b: 2}...]</span>
</code></pre></div><p>现在所有主流浏览器都使用稳定的排序算法。实际上，这意味着如果我们有一个对象数组，并在给定的键上对它们进行排序，那么列表中的元素将保持相对于具有相同键的其他对象的位置。</p> <h2 id="_5-9-function-prototype-tostring-的重新修订"><a href="#_5-9-function-prototype-tostring-的重新修订" class="header-anchor">#</a> 5.9 Function.prototype.toString() 的重新修订</h2> <p>在之前，Function.prototype.toString()只会返回函数的主体，但没有注释和空格。</p> <p>从 ES2019 开始，Function.prototype.toString() 将从头到尾返回源代码中的实际文本片段。这意味着还将返回注释、空格和语法详细信息。</p> <div class="language-js extra-class"><pre class="language-js"><code>foo<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 'function /* a comment  */ foo () {}'</span>
</code></pre></div><h1 id="六、es2020"><a href="#六、es2020" class="header-anchor">#</a> 六、ES2020</h1> <h2 id="_6-1-class-的私有变量"><a href="#_6-1-class-的私有变量" class="header-anchor">#</a> 6.1 class 的私有变量</h2> <p>通过 # 可以给 class 添加私有变量：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
  #number <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#number<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#number
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span><span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">//11</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>#number<span class="token punctuation">)</span>    <span class="token comment">//调用class的私有变量会报错：SyntaxError</span>
</code></pre></div><h2 id="_6-2-promise-allsettled"><a href="#_6-2-promise-allsettled" class="header-anchor">#</a> 6.2 Promise.allSettled</h2> <p>当我们处理多个 Promise 时，特别是当它们相互依赖时，记录每个 Promise 所发生的事情来调试错误是很有必要的。</p> <p>通过 Promise.allSettled，我们可以创建一个新的 Promise，它只在所有传递给它的 Promise 都完成时返回一个数组，其中包含每个 Promise 的数据。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> rej</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> rej</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>rej<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// [</span>
<span class="token comment">//   Object { status: &quot;fulfilled&quot;, value: undefined},</span>
<span class="token comment">//   Object { status: &quot;rejected&quot;, reason: undefined}</span>
<span class="token comment">// ]</span>
</code></pre></div><h2 id="_6-3-空位合并运算符"><a href="#_6-3-空位合并运算符" class="header-anchor">#</a> 6.3 空位合并运算符（.?）</h2> <p>由于 JavaScript 是动态类型的，因此在分配变量时，需要牢记 JavaScript 对真实/错误值的处理。 如果我们有一个带有某些值的对象，有时我们希望允许使用从技术上讲是虚假的值，例如空字符串或数字 0。设置默认值不是一个非常合理的方法，因为默认值会覆盖应为有效值的值。</p> <p>通常情况下，我们使用 ||</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  profile<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>name <span class="token operator">||</span> <span class="token string">&quot;Anonymous&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Anonymous</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">||</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18</span>
</code></pre></div><p>现在我们可以使用 ?? 操作符，使其类型更严格一些，这只允许在值为 null 或未定义时使用默认值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  profile<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>name <span class="token operator">??</span> <span class="token string">&quot;Anonymous&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">??</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
</code></pre></div><h2 id="_6-4-可选链"><a href="#_6-4-可选链" class="header-anchor">#</a> 6.4 可选链（.?）</h2> <p>与合并空操作符类似，JavaScript 在处理错误值时可能无法按我们希望的方式工作。如果我们想要的是未定义的，我们可以返回一个值，但是如果到它的路径是未定义的呢？通过在.之前添加一个问号，我们可以使值的路径的任何部分成为可选的，这样我们仍然可以与它交互。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>name <span class="token operator">??</span> <span class="token string">&quot;Anonymous&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// person.profile is undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token operator">?.</span>profile<span class="token operator">?.</span>name <span class="token operator">??</span> <span class="token string">&quot;Anonymous&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token operator">?.</span>profile<span class="token operator">?.</span>age <span class="token operator">??</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_6-5-bigint"><a href="#_6-5-bigint" class="header-anchor">#</a> 6.5 BigInt</h2> <p>JavaScript 可以处理的最大安全整数是(2^53 - 1)，我们可以在 MAX_SAFE_INTEGER 中看到。</p> <p>但是，最大的整数有时候可能会不够用。因此 ES2020 引入了 BigInt 这个标准内置对象，可以表示任意大的整数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> theBiggestInt <span class="token operator">=</span> <span class="token number">9007199254740991n</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> alsoHuge <span class="token operator">=</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token number">9007199254740991</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 9007199254740991n</span>
<span class="token keyword">const</span> hugeString <span class="token operator">=</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token string">&quot;9007199254740991&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 9007199254740991n</span>
<span class="token keyword">const</span> hugeHex <span class="token operator">=</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token string">&quot;0x1fffffffffffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 9007199254740991n</span>
<span class="token keyword">const</span> hugeBin <span class="token operator">=</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token string">&quot;0b11111111111111111111111111111111111111111111111111111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 9007199254740991n</span>
</code></pre></div><p>BigInt 在某些方面类似于 Number ，但是也有几个关键的不同点：</p> <ul><li>不能用于 Math 对象中的方法；</li> <li>不能和任何 Number 实例混合运算，两者必须转换成同一种类型。在两种类型来回转换时要小心，因为 BigInt 变量在转换成 Number 变量时可能会丢失精度。</li></ul> <h2 id="_6-6-动态-import"><a href="#_6-6-动态-import" class="header-anchor">#</a> 6.6 动态 import</h2> <p>关键字 import 可以像调用函数一样来动态的导入模块。以这种方式调用，将返回一个 promise。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'/modules/my-module.js'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something with the module.</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这种使用方式也支持 await 关键字。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> module <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'/modules/my-module.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_6-7-globalthis"><a href="#_6-7-globalthis" class="header-anchor">#</a> 6.7 globalThis</h2> <p>JavaScript 语言存在一个顶层对象，它提供全局环境（即全局作用域），所有代码都是在这个环境中运行。但是，顶层对象在各种实现里面是不统一的：</p> <ul><li>浏览器里面，顶层对象是 window，但 Node 和 Web Worker 没有window。</li> <li>浏览器和 Web Worker 里面，self 也指向顶层对象，但是 Node 没有 self。</li> <li>Node 里面，顶层对象是 global，但其他环境都不支持。</li></ul> <p>ES2020 的 globalThis 对象则始终会引用着全局对象，而不用关心代码在哪运行。</p> <h2 id="_6-8-string-prototype-matchall"><a href="#_6-8-string-prototype-matchall" class="header-anchor">#</a> 6.8 String.prototype.matchAll()</h2> <p>matchAll() 方法返回一个包含所有匹配正则表达式的结果及分组捕获组的迭代器。可以使用一个扩展运算符（...），把迭代器转换为数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> regexp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">t(e)(st(\d?))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'test1test2'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>str<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regexp<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_6-9-for-in-mechanics"><a href="#_6-9-for-in-mechanics" class="header-anchor">#</a> 6.9 for-in mechanics</h2> <p>以前，不同引擎下 for-in 循环出来的内容顺序可能是不一样的。</p> <p>ES2020 后，顺序进行了标准化</p> <h2 id="_6-10-import-meta"><a href="#_6-10-import-meta" class="header-anchor">#</a> 6.10 import.meta</h2> <p>开发者使用一个模块时，有时需要知道模板本身的一些信息（比如模块的路径）。</p> <p>ES2020 为 import 命令添加了一个元属性 import.meta，返回当前模块的元信息。</p> <p>import.meta 只能在模块内部使用，如果在模块外部使用会报错。这个属性返回一个对象，该对象的各种属性就是当前运行的脚本的元信息。具体包含哪些属性，标准没有规定，由各个运行环境自行决定。</p> <p>一般来说，import.meta 至少会有下面两个属性：</p> <ul><li>import.meta.url</li></ul> <p>import.meta.url 返回当前模块的 URL 路径。举例来说，如果当前模块主文件的路径是 https://foo.com/main.js，import.meta.url 就返回这个路径。如果模块里面还有一个数据文件 data.txt，那么就可以用下面的代码，获取这个数据文件的路径：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
</code></pre></div><ul><li>import.meta.scriptElement</li></ul> <p>import.meta.scriptElement 是浏览器特有的元属性，返回加载模块的那个 <script></script></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/js/extends.html" class="prev">
        继承
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.783a6ee2.js" defer></script><script src="/assets/js/2.5a5ecfa5.js" defer></script><script src="/assets/js/13.0bc6ce2c.js" defer></script>
  </body>
</html>
