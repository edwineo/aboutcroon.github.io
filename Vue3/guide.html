<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. Vue3 åŸºç¡€ | Croon Liu</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="Replace the stars and rivers in the body with unlimited methods for the future">
    
    <link rel="preload" href="/assets/css/0.styles.d236ad96.css" as="style"><link rel="preload" href="/assets/js/app.356218c2.js" as="script"><link rel="preload" href="/assets/js/2.1547bbba.js" as="script"><link rel="preload" href="/assets/js/15.a09c666d.js" as="script"><link rel="prefetch" href="/assets/js/10.7d9019c4.js"><link rel="prefetch" href="/assets/js/11.2b41e043.js"><link rel="prefetch" href="/assets/js/12.23bc9545.js"><link rel="prefetch" href="/assets/js/13.e76e8c6a.js"><link rel="prefetch" href="/assets/js/14.d35f4302.js"><link rel="prefetch" href="/assets/js/16.33dc3160.js"><link rel="prefetch" href="/assets/js/17.521828eb.js"><link rel="prefetch" href="/assets/js/18.e694f17a.js"><link rel="prefetch" href="/assets/js/19.c1ec16da.js"><link rel="prefetch" href="/assets/js/20.fb6ee556.js"><link rel="prefetch" href="/assets/js/21.f4053037.js"><link rel="prefetch" href="/assets/js/22.fcbbeb53.js"><link rel="prefetch" href="/assets/js/23.d02ba915.js"><link rel="prefetch" href="/assets/js/24.765c0f60.js"><link rel="prefetch" href="/assets/js/25.b6397f75.js"><link rel="prefetch" href="/assets/js/26.a37c5cf0.js"><link rel="prefetch" href="/assets/js/3.557dccde.js"><link rel="prefetch" href="/assets/js/4.09ee8a39.js"><link rel="prefetch" href="/assets/js/5.30fca801.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.2f300486.js"><link rel="prefetch" href="/assets/js/8.d34c362f.js"><link rel="prefetch" href="/assets/js/9.60270935.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d236ad96.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Croon Liu</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><span class="title">Blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="Blog" class="mobile-dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/HTTP/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/" class="nav-link router-link-active">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/SSR/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/å¼€å‘ææ•ˆ/" class="nav-link">
  å¼€å‘ææ•ˆ
</a></li><li class="dropdown-item"><!----> <a href="/é«˜çº§ç¨‹åºè®¾è®¡/" class="nav-link">
  é«˜çº§ç¨‹åºè®¾è®¡
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/aboutcroon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><span class="title">Blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="Blog" class="mobile-dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/HTTP/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/" class="nav-link router-link-active">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/SSR/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/å¼€å‘ææ•ˆ/" class="nav-link">
  å¼€å‘ææ•ˆ
</a></li><li class="dropdown-item"><!----> <a href="/é«˜çº§ç¨‹åºè®¾è®¡/" class="nav-link">
  é«˜çº§ç¨‹åºè®¾è®¡
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/aboutcroon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Vue3/introduce.html" class="sidebar-link">1. Vue3 åˆæ­¥ä»‹ç»</a></li><li><a href="/Vue3/guide.html" aria-current="page" class="active sidebar-link">1. Vue3 åŸºç¡€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_1-1-åº”ç”¨-ç»„ä»¶å®ä¾‹" class="sidebar-link">1.1 åº”ç”¨ &amp; ç»„ä»¶å®ä¾‹</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_1-2-data-property-å’Œæ–¹æ³•" class="sidebar-link">1.2 Data Property å’Œæ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_1-3-è¡¨å•è¾“å…¥ç»‘å®š" class="sidebar-link">1.3 è¡¨å•è¾“å…¥ç»‘å®š</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_1-4-ç»„ä»¶åŸºç¡€" class="sidebar-link">1.4 ç»„ä»¶åŸºç¡€</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_2-1-é-prop-çš„-attribute" class="sidebar-link">2.1 é Prop çš„ Attribute</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_2-2-è‡ªå®šä¹‰äº‹ä»¶" class="sidebar-link">2.2 è‡ªå®šä¹‰äº‹ä»¶</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_2-3-å¼‚æ­¥ç»„ä»¶" class="sidebar-link">2.3 å¼‚æ­¥ç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_3-1-teleport" class="sidebar-link">3.1 Teleport</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_3-2-suspense" class="sidebar-link">3.2 Suspense</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_4-1-å“åº”æ€§åŸç†" class="sidebar-link">4.1 å“åº”æ€§åŸç†</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_4-2-å“åº”æ€§åŸºç¡€" class="sidebar-link">4.2 å“åº”æ€§åŸºç¡€</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_4-3-å“åº”å¼è®¡ç®—å’Œä¾¦å¬" class="sidebar-link">4.3 å“åº”å¼è®¡ç®—å’Œä¾¦å¬</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_5-1-åŸºç¡€ç”¨æ³•" class="sidebar-link">5.1 åŸºç¡€ç”¨æ³•</a></li><li class="sidebar-sub-header"><a href="/Vue3/guide.html#_5-2-setup" class="sidebar-link">5.2 Setup</a></li></ul></li><li><a href="/Vue3/migration.html" class="sidebar-link">1. v-for ä¸­çš„ Ref æ•°ç»„</a></li><li><a href="/Vue3/api.html" class="sidebar-link">1. åº”ç”¨é…ç½®</a></li><li><a href="/Vue3/router.html" class="sidebar-link">1. è·¯ç”±åŸºç¡€</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-vue3-åŸºç¡€"><a href="#_1-vue3-åŸºç¡€" class="header-anchor">#</a> 1. Vue3 åŸºç¡€</h1> <h2 id="_1-1-åº”ç”¨-ç»„ä»¶å®ä¾‹"><a href="#_1-1-åº”ç”¨-ç»„ä»¶å®ä¾‹" class="header-anchor">#</a> 1.1 åº”ç”¨ &amp; ç»„ä»¶å®ä¾‹</h2> <h3 id="_1-1-1-åˆ›å»ºä¸€ä¸ªåº”ç”¨å®ä¾‹"><a href="#_1-1-1-åˆ›å»ºä¸€ä¸ªåº”ç”¨å®ä¾‹" class="header-anchor">#</a> 1.1.1 åˆ›å»ºä¸€ä¸ªåº”ç”¨å®ä¾‹</h3> <p>æ¯ä¸ª Vue åº”ç”¨éƒ½æ˜¯é€šè¿‡ç”¨ <code>createApp</code> å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„<strong>åº”ç”¨å®ä¾‹</strong>å¼€å§‹çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">/* é€‰é¡¹ */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>Vue2 ä¸­ï¼Œæ¯ä¸ªåº”ç”¨æ˜¯é€šè¿‡ç”¨ Vue å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ Vue å®ä¾‹å¼€å§‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// é€‰é¡¹</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></blockquote> <p>è¯¥åº”ç”¨å®ä¾‹æ˜¯ç”¨æ¥åœ¨åº”ç”¨ä¸­æ³¨å†Œâ€œå…¨å±€â€ç»„ä»¶çš„ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'SearchInput'</span><span class="token punctuation">,</span> SearchInputComponent<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'focus'</span><span class="token punctuation">,</span> FocusDirective<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>LocalePlugin<span class="token punctuation">)</span>
</code></pre></div><p>åº”ç”¨å®ä¾‹æš´éœ²çš„å¤§å¤šæ•°æ–¹æ³•éƒ½ä¼šè¿”å›è¯¥åŒä¸€å®ä¾‹ï¼Œå®ƒå…è®¸é“¾å¼è°ƒç”¨ï¼Œä¸‹åˆ—å†™æ³•çš„ä½œç”¨ä¸ä¸Šé¢çš„ç›¸åŒï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'SearchInput'</span><span class="token punctuation">,</span> SearchInputComponent<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'focus'</span><span class="token punctuation">,</span> FocusDirective<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>LocalePlugin<span class="token punctuation">)</span>
</code></pre></div><h3 id="_1-1-2-æ ¹ç»„ä»¶"><a href="#_1-1-2-æ ¹ç»„ä»¶" class="header-anchor">#</a> 1.1.2 æ ¹ç»„ä»¶</h3> <p>ä¼ é€’ç»™ <code>createApp</code> çš„é€‰é¡¹æ˜¯ç”¨äºé…ç½®<strong>æ ¹ç»„ä»¶</strong>çš„ã€‚å½“æˆ‘ä»¬<strong>æŒ‚è½½</strong>åº”ç”¨æ—¶ï¼Œè¯¥ç»„ä»¶è¢«ç”¨ä½œæ¸²æŸ“çš„èµ·ç‚¹ã€‚</p> <p>ä¸€ä¸ªåº”ç”¨å®ä¾‹æ˜¯éœ€è¦è¢«æŒ‚è½½åˆ°ä¸€ä¸ª DOM å…ƒç´ ä¸­çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŠŠä¸€ä¸ª Vue åº”ç”¨å®ä¾‹æŒ‚è½½åˆ° <code>&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code>ï¼Œæˆ‘ä»¬åº”è¯¥ä¼ é€’ <code>#app</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> RootComponent <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">/* é€‰é¡¹ */</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span>RootComponent<span class="token punctuation">)</span>

<span class="token comment">// å°†åº”ç”¨å®ä¾‹ app æŒ‚è½½åˆ° &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span>
<span class="token keyword">const</span> ViewModel <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>  <span class="token comment">// è¿™ä¸ª ViewModel è¡¨ç¤ºä¸€ä¸ªç»„ä»¶å®ä¾‹</span>
</code></pre></div><p>æ ¹ç»„ä»¶ä¸å…¶ä»–ç»„ä»¶æ²¡ä»€ä¹ˆä¸åŒï¼Œé…ç½®é€‰é¡¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€å¯¹åº”çš„ç»„ä»¶å®ä¾‹è¡Œä¸ºä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p> <h3 id="_1-1-3-ç»„ä»¶å®ä¾‹-property"><a href="#_1-1-3-ç»„ä»¶å®ä¾‹-property" class="header-anchor">#</a> 1.1.3 ç»„ä»¶å®ä¾‹ property</h3> <p>åœ¨ <code>data</code> ä¸­å®šä¹‰çš„ property æ˜¯é€šè¿‡ç»„ä»¶å®ä¾‹æš´éœ²çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> vm <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// =&gt; 4</span>
</code></pre></div><p>è¿˜æœ‰å„ç§å…¶ä»–çš„ç»„ä»¶é€‰é¡¹ï¼Œå¯ä»¥å°†ç”¨æˆ·å®šä¹‰çš„ property æ·»åŠ åˆ°ç»„ä»¶å®ä¾‹ä¸­ï¼Œä¾‹å¦‚ <code>methods</code>ï¼Œ<code>props</code>ï¼Œ<code>computed</code>ï¼Œ<code>inject</code> å’Œ <code>setup</code>ã€‚ç»„ä»¶å®ä¾‹çš„æ‰€æœ‰ propertyï¼Œæ— è®ºå¦‚ä½•å®šä¹‰ï¼Œéƒ½å¯ä»¥åœ¨ç»„ä»¶çš„æ¨¡æ¿ä¸­è®¿é—®ã€‚</p> <p>Vue è¿˜é€šè¿‡ç»„ä»¶å®ä¾‹æš´éœ²äº†ä¸€äº› <code>å†…ç½® property</code>ï¼Œå¦‚ <code>$attrs</code> å’Œ <code>$emit</code>ã€‚è¿™äº› property éƒ½æœ‰ä¸€ä¸ª <code>$</code> å‰ç¼€ï¼Œä»¥é¿å…ä¸ç”¨æˆ·å®šä¹‰çš„ property åå†²çªã€‚</p> <h3 id="_1-1-4-ç”Ÿå‘½å‘¨æœŸé’©å­"><a href="#_1-1-4-ç”Ÿå‘½å‘¨æœŸé’©å­" class="header-anchor">#</a> 1.1.4 ç”Ÿå‘½å‘¨æœŸé’©å­</h3> <p>vue3 çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°çš„å˜åŒ–æ˜¯ï¼š</p> <ul><li>beforeDestroy æ”¹åä¸º <code>beforeUnmount</code>ï¼Œdestroyed æ”¹åä¸º <code>unmounted</code></li> <li>æ–°å¢äº† <code>onRenderTracked</code> å’Œ <code>onRenderTriggered</code> ä¸¤ä¸ªè°ƒè¯•ç”¨çš„ debug é’©å­å‡½æ•°</li></ul> <p>åœ¨ä½¿ç”¨æ–¹é¢ï¼Œé’©å­å‡½æ•°éƒ½å¯ä»¥å†™åœ¨ <code>setup()</code> å‡½æ•°ä¸­ï¼Œå…·ä½“å†™æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>beforeCreate <span class="token operator">-</span><span class="token operator">&gt;</span> use <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
created <span class="token operator">-</span><span class="token operator">&gt;</span> use <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
beforeMount <span class="token operator">-</span><span class="token operator">&gt;</span> onBeforeMount
mounted <span class="token operator">-</span><span class="token operator">&gt;</span> onMounted
beforeUpdate <span class="token operator">-</span><span class="token operator">&gt;</span> onBeforeUpdate
updated <span class="token operator">-</span><span class="token operator">&gt;</span> onUpdated
beforeUnmount <span class="token operator">-</span><span class="token operator">&gt;</span> onBeforeUnmount
unmounted <span class="token operator">-</span><span class="token operator">&gt;</span> onUnmounted
activated <span class="token operator">-</span><span class="token operator">&gt;</span> onActivated
deactivated <span class="token operator">-</span><span class="token operator">&gt;</span> onDeactivated
errorCaptured <span class="token operator">-</span><span class="token operator">&gt;</span> onErrorCaptured

onRenderTracked
onRenderTriggered
</code></pre></div><p>å› ä¸º <code>beforeCreate</code>ã€<code>created</code> ä¸ setup() å‡ ä¹æ˜¯åŒæ—¶è¿›è¡Œçš„ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªé’©å­ä¸­çš„ä¸šåŠ¡é€»è¾‘å¯ä»¥ç›´æ¥å†™åœ¨ setup() ä¸­ã€‚</p> <p><code>onRenderTracked</code> å’Œ <code>onRenderTriggered</code> ç”¨äºè°ƒè¯•ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ä¼šè§¦å‘ã€‚</p> <ul><li><code>onTrack</code> å°†åœ¨å“åº”å¼ property æˆ– ref ä½œä¸ºä¾èµ–é¡¹è¢«è¿½è¸ªæ—¶è¢«è°ƒç”¨ã€‚</li> <li><code>onTrigger</code> å°†åœ¨ä¾èµ–é¡¹å˜æ›´å¯¼è‡´å‰¯ä½œç”¨è¢«è§¦å‘æ—¶è¢«è°ƒç”¨ã€‚</li></ul> <p>ç¤ºä¾‹ï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>{{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>{{ double }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>increase<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ğŸ‘ +1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> toRefs<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> onRenderTriggered <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">interface</span> <span class="token class-name">DataProps</span> <span class="token punctuation">{</span>
  count<span class="token operator">:</span> number
  <span class="token function-variable function">increase</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  double<span class="token operator">:</span> number
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onRenderTriggered</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">const</span> data<span class="token operator">:</span> DataProps <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token function-variable function">increase</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span>count<span class="token operator">++</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      double<span class="token operator">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> data<span class="token punctuation">.</span>count <span class="token operator">*</span> <span class="token number">2</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> refData <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>refData
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº† <code>onMounted</code> å’Œ <code>onRenderTriggerd</code> ä¸¤ä¸ªé’©å­ã€‚å½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œ<code>onRenderTriggerd</code> æ‰“å°çš„ event å¯¹è±¡å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>effect<span class="token operator">:</span> Æ’ <span class="token function">reactiveEffect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
key<span class="token operator">:</span> <span class="token string">&quot;count&quot;</span>
newValue<span class="token operator">:</span> <span class="token number">1</span>
oldTarget<span class="token operator">:</span> <span class="token keyword">undefined</span>
oldValue<span class="token operator">:</span> <span class="token number">0</span>
target<span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> double<span class="token operator">:</span> ComputedRefImpl<span class="token punctuation">,</span> increase<span class="token operator">:</span> Æ’<span class="token punctuation">}</span>
type<span class="token operator">:</span> <span class="token string">&quot;set&quot;</span>
__proto__<span class="token operator">:</span> Object
</code></pre></div><p>å…¶ä¸­ï¼Œkey ä»£è¡¨è¢«æ›´æ–°çš„å€¼ï¼Œtype ä»£è¡¨æ“ä½œçš„ç±»å‹ï¼ŒnewValue å’Œ oldValue åˆ†åˆ«ä»£è¡¨æ›´æ–°åå’Œæ›´æ–°å‰çš„å€¼</p> <h2 id="_1-2-data-property-å’Œæ–¹æ³•"><a href="#_1-2-data-property-å’Œæ–¹æ³•" class="header-anchor">#</a> 1.2 Data Property å’Œæ–¹æ³•</h2> <h3 id="_1-2-1-data-property"><a href="#_1-2-1-data-property" class="header-anchor">#</a> 1.2.1 Data Property</h3> <p>ç»„ä»¶çš„ <code>data</code> é€‰é¡¹æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚Vue åœ¨åˆ›å»ºæ–°ç»„ä»¶å®ä¾‹çš„è¿‡ç¨‹ä¸­è°ƒç”¨æ­¤å‡½æ•°ã€‚å®ƒåº”è¯¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶å Vue ä¼šé€šè¿‡å“åº”æ€§ç³»ç»Ÿå°†å…¶åŒ…è£¹èµ·æ¥ï¼Œå¹¶ä»¥ <code>$data</code> çš„å½¢å¼å­˜å‚¨åœ¨ç»„ä»¶å®ä¾‹ä¸­ã€‚ä¸ºæ–¹ä¾¿èµ·è§ï¼Œè¯¥å¯¹è±¡çš„ä»»ä½• <code>é¡¶çº§ property</code> ä¹Ÿç›´æ¥é€šè¿‡ç»„ä»¶å®ä¾‹æš´éœ²å‡ºæ¥ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> vm <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$data<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// =&gt; 4</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>count<span class="token punctuation">)</span>       <span class="token comment">// =&gt; 4</span>

<span class="token comment">// ä¿®æ”¹ vm.count çš„å€¼ä¹Ÿä¼šæ›´æ–° $data.count</span>
vm<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$data<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// =&gt; 5</span>

<span class="token comment">// åä¹‹äº¦ç„¶</span>
vm<span class="token punctuation">.</span>$data<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// =&gt; 6</span>
</code></pre></div><p>è¿™äº›å®ä¾‹ property ä»…åœ¨å®ä¾‹é¦–æ¬¡åˆ›å»ºæ—¶è¢«æ·»åŠ ï¼Œæ‰€ä»¥ä½ éœ€è¦ç¡®ä¿å®ƒä»¬éƒ½åœ¨ <code>data</code> å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­ã€‚å¿…è¦æ—¶ï¼Œè¦å¯¹å°šæœªæä¾›æ‰€éœ€å€¼çš„ property ä½¿ç”¨ <code>null</code>ã€<code>undefined</code> æˆ–å…¶ä»–å ä½çš„å€¼ã€‚</p> <p>Vue ä½¿ç”¨ <code>$</code> å‰ç¼€é€šè¿‡ç»„ä»¶å®ä¾‹æš´éœ²è‡ªå·±çš„å†…ç½® APIã€‚å®ƒè¿˜ä¸ºå†…éƒ¨ property ä¿ç•™ <code>_</code> å‰ç¼€ã€‚ä½ åº”è¯¥é¿å…ä½¿ç”¨è¿™ä¸¤ä¸ªå­—ç¬¦å¼€å¤´çš„çš„ <code>é¡¶çº§ data property</code> åç§°ã€‚</p> <h3 id="_1-2-2-æ–¹æ³•"><a href="#_1-2-2-æ–¹æ³•" class="header-anchor">#</a> 1.2.2 æ–¹æ³•</h3> <p>æˆ‘ä»¬ç”¨ <code>methods</code> é€‰é¡¹å‘ç»„ä»¶å®ä¾‹æ·»åŠ æ–¹æ³•ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªåŒ…å«æ‰€éœ€æ–¹æ³•çš„å¯¹è±¡ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// `this` æŒ‡å‘è¯¥ç»„ä»¶å®ä¾‹</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> vm <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// =&gt; 4</span>

vm<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// =&gt; 5</span>
</code></pre></div><p>Vue è‡ªåŠ¨ä¸º <code>methods</code> ç»‘å®š <code>this</code>ï¼Œä»¥ä¾¿äºå®ƒå§‹ç»ˆæŒ‡å‘ç»„ä»¶å®ä¾‹ã€‚è¿™å°†ç¡®ä¿æ–¹æ³•åœ¨ç”¨ä½œäº‹ä»¶ç›‘å¬æˆ–å›è°ƒæ—¶ä¿æŒæ­£ç¡®çš„ <code>this</code> æŒ‡å‘ã€‚</p> <blockquote><p>åœ¨å®šä¹‰ <code>methods</code> æ—¶åº”é¿å…ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå› ä¸ºè¿™ä¼šé˜»æ­¢ Vue ç»‘å®šæ°å½“çš„ <code>this</code> æŒ‡å‘ã€‚</p></blockquote> <p>ä¹Ÿå¯ä»¥ç›´æ¥ä»æ¨¡ç‰ˆä¸­è°ƒç”¨æ–¹æ³•ï¼Œä½†æ˜¯é€šå¸¸è¿™ç§æƒ…å†µæ¢åš <code>è®¡ç®—å±æ€§</code> ä¼šæ›´å¥½ã€‚</p> <p>ä½ å¯ä»¥åœ¨æ¨¡æ¿æ”¯æŒ JavaScript è¡¨è¾¾å¼çš„ä»»ä½•åœ°æ–¹è°ƒç”¨æ–¹æ³•ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>toTitleDate(date)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  {{ formatDate(date) }}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å¦‚æœ <code>toTitleDate</code> æˆ– <code>formatDate</code> è®¿é—®ä»»ä½•å“åº”å¼æ•°æ®ï¼Œåˆ™å°†å…¶ä½œä¸ºæ¸²æŸ“ä¾èµ–é¡¹è¿›è¡Œè·Ÿè¸ªï¼Œå°±åƒç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨è¿‡ä¸€æ ·ã€‚</p> <h3 id="_1-2-3-é˜²æŠ–å’ŒèŠ‚æµ"><a href="#_1-2-3-é˜²æŠ–å’ŒèŠ‚æµ" class="header-anchor">#</a> 1.2.3 é˜²æŠ–å’ŒèŠ‚æµ</h3> <h2 id="_1-3-è¡¨å•è¾“å…¥ç»‘å®š"><a href="#_1-3-è¡¨å•è¾“å…¥ç»‘å®š" class="header-anchor">#</a> 1.3 è¡¨å•è¾“å…¥ç»‘å®š</h2> <h3 id="_1-3-1-åœ¨å½“å‰ç»„ä»¶ä½¿ç”¨-v-model"><a href="#_1-3-1-åœ¨å½“å‰ç»„ä»¶ä½¿ç”¨-v-model" class="header-anchor">#</a> 1.3.1 åœ¨å½“å‰ç»„ä»¶ä½¿ç”¨ v-model</h3> <p>ç”¨ <code>v-model</code> æŒ‡ä»¤å¯ä»¥åœ¨è¡¨å• <code>&lt;input&gt;</code>ã€<code>&lt;textarea&gt;</code> åŠ <code>&lt;select&gt;</code> å…ƒç´ ä¸Šåˆ›å»ºåŒå‘æ•°æ®ç»‘å®šï¼Œå®ƒä¼šæ ¹æ®æ§ä»¶ç±»å‹è‡ªåŠ¨é€‰å–æ­£ç¡®çš„æ–¹æ³•æ¥æ›´æ–°å…ƒç´ ã€‚</p> <p>ä½† <code>v-model</code> æœ¬è´¨ä¸Šä¸è¿‡æ˜¯è¯­æ³•ç³–ï¼Œå®ƒè´Ÿè´£ç›‘å¬ç”¨æˆ·çš„è¾“å…¥äº‹ä»¶ä»¥æ›´æ–°æ•°æ®ï¼Œå¹¶å¯¹ä¸€äº›æç«¯åœºæ™¯è¿›è¡Œä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚<code>v-model</code> åœ¨å†…éƒ¨ä¸ºä¸åŒçš„è¾“å…¥å…ƒç´ ä½¿ç”¨ä¸åŒçš„ property å¹¶æŠ›å‡ºä¸åŒçš„äº‹ä»¶ï¼š</p> <ul><li>text å’Œ textarea å…ƒç´ ä½¿ç”¨ <code>value</code> property å’Œ <code>input</code> äº‹ä»¶ï¼›</li> <li>checkbox å’Œ radio ä½¿ç”¨ <code>checked</code> property å’Œ <code>change</code> äº‹ä»¶ï¼›</li> <li>select å­—æ®µå°† <code>value</code> ä½œä¸º prop å¹¶å°† <code>change</code> ä½œä¸ºäº‹ä»¶ã€‚</li></ul> <p>æ–‡æœ¬ï¼ˆTextï¼‰ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>edit me<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Message is: {{ message }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å¤šè¡Œæ–‡æœ¬ï¼ˆtextareaï¼‰ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>Multiline message is:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">white-space</span><span class="token punctuation">:</span> pre-line<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>{{ message }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add multiple lines<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å¤é€‰æ¡†ï¼ˆCheckboxï¼‰ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checked<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ checked }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å•é€‰æ¡†ï¼ˆRadioï¼‰ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>v-model-radiobutton<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>one<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>One<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>picked<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>one<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>One<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>two<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Two<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>picked<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>two<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Two<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>Picked: {{ picked }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>é€‰æ‹©æ¡†ï¼ˆSelectï¼‰ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>v-model-select<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>demo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selected<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">disabled</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Please select one<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">&gt;</span></span>A<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">&gt;</span></span>B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">&gt;</span></span>C<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>Selected: {{ selected }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_1-3-2-åœ¨ç»„ä»¶ä¸Šä½¿ç”¨-v-model"><a href="#_1-3-2-åœ¨ç»„ä»¶ä¸Šä½¿ç”¨-v-model" class="header-anchor">#</a> 1.3.2 åœ¨ç»„ä»¶ä¸Šä½¿ç”¨ v-model</h3> <p>vue2 ä¸­ï¼Œåœ¨ç»„ä»¶ä¸Šä½¿ç”¨ <code>v-model</code> æ—¶ï¼Œv-model ä¼šé»˜è®¤åˆ©ç”¨ <code>value</code> å½“ä½œ propertyï¼Œé»˜è®¤åˆ©ç”¨åä¸º <code>input</code> çš„äº‹ä»¶ã€‚ç”¨åœ¨æ™®é€šçš„ text å’Œ textarea ä¸Šæ—¶æ˜¯è¿™æ ·ï¼Œä½†æ˜¯å½“ç”¨åœ¨ checkbox å’Œ radio ä¸Šæ—¶ï¼Œæ˜¯å°† checked å½“ä½œ propertyï¼Œchange å½“ä½œäº‹ä»¶ã€‚</p> <p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œvue2 æä¾›çš„è§£å†³æ–¹æ¡ˆæ˜¯å†™ä¸€ä¸ª model å­—æ®µï¼Œé‡Œé¢å«æœ‰æƒ³ç»‘å®šçš„ property å’Œ æƒ³è§¦å‘çš„äº‹ä»¶åç§°ï¼Œä»è€Œä½¿ç”¨model æ¥è¦†ç›–é»˜è®¤çš„ value å’Œ inputï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>model<span class="token operator">:</span> <span class="token punctuation">{</span>
  prop<span class="token operator">:</span> <span class="token string">&quot;checked&quot;</span><span class="token punctuation">,</span>
  event<span class="token operator">:</span> <span class="token string">&quot;change&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ˜¾è€Œæ˜“è§ï¼Œvue2 è¿™æ ·çš„åšæ³•æœ‰å‡ ä¸ªç¼ºç‚¹ï¼š</p> <ul><li>éœ€è¦å®šä¹‰ä¸€ä¸ªæ–°çš„ modelï¼Œæ¯”è¾ƒç¹ç</li> <li>åªèƒ½æ”¯æŒä¸€ä¸ª v-modelï¼Œå½“ç»„ä»¶éœ€è¦åŒå‘ç»‘å®šå¤šä¸ªå€¼æ—¶å­˜åœ¨ä¸€å®šå›°éš¾</li></ul> <p>é’ˆå¯¹æ­¤é—®é¢˜ï¼Œvue3 ä¸­ä½¿ç”¨ modelValue ä½œä¸º propertyï¼Œä½¿ç”¨ä¸è¯¥ modelValue å¯¹åº”çš„ update:modelValue åç§°ä½œä¸ºäº‹ä»¶åã€‚è¿™æ ·ï¼Œproperty å’Œ äº‹ä»¶é—´å°±èƒ½å¤Ÿä¸€ä¸€å¯¹åº”èµ·æ¥ï¼Œå°±ä¸å­˜åœ¨ä¸Šè¿°çš„é—®é¢˜äº†ï¼Œä¸”å…¶æ”¯æŒå¤šä¸ª v-modelã€‚</p> <p>åœ¨ vue3 ä¸­ä½¿ç”¨ v-model æ—¶ï¼ŒåŒç†ï¼Œéœ€è¦ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶ï¼Œè‡ªå®šä¹‰äº‹ä»¶å¯ä»¥ç”¨äºåˆ›å»º <code>v-model</code> çš„è‡ªå®šä¹‰è¾“å…¥ç»„ä»¶ï¼Œé€šå¸¸æƒ…å†µä¸‹è®°ä½ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchText<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>ç­‰ä»·äºï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchText<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchText = $event.target.value<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>è€Œå½“åœ¨ç»„ä»¶ä¸Šä½¿ç”¨ v-model æ—¶ï¼Œçˆ¶ç»„ä»¶çš„ v-model åˆ™ä¸ºï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchText<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-input</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ç­‰ä»·äºè¿™æ ·ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-input</span>
  <span class="token attr-name">:model-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchText<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">@update:</span>model-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>searchText = $event<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-input</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä¸ºäº†è®©å®ƒæ­£å¸¸å·¥ä½œï¼Œè¿™ä¸ª <code>custom-input</code> ç»„ä»¶å†…çš„ <code>&lt;input&gt;</code> å¿…é¡»ï¼š</p> <ul><li>å°†å…¶ <code>value</code> attribute ç»‘å®šåˆ°ä¸€ä¸ªåå« <code>modelValue</code> çš„ prop ä¸Š</li> <li>åœ¨å…¶ <code>input</code> äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œå°†æ–°çš„å€¼é€šè¿‡è‡ªå®šä¹‰çš„ <code>update:modelValue</code> äº‹ä»¶æŠ›å‡º</li></ul> <blockquote><p>ä¹Ÿå°±æ˜¯å±æ€§åä¸º <code>modelValue</code>, äº‹ä»¶åä¸º <code>update:modelValue</code>ï¼ˆè¿™é‡Œ update åé¢çš„ modelValue çš„å€¼å’Œå±æ€§å modelValue ä¿æŒä¸€è‡´ï¼‰ã€‚</p></blockquote> <p>æ‰€ä»¥å­ç»„ä»¶ <code>custom-input</code> å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'custom-input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'modelValue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;input
      :value=&quot;modelValue&quot;
      @input=&quot;$emit('update:modelValue', $event.target.value)&quot;
    &gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_1-3-3-ä½¿ç”¨-computed-æ”¹å†™è‡ªå®šä¹‰-v-model"><a href="#_1-3-3-ä½¿ç”¨-computed-æ”¹å†™è‡ªå®šä¹‰-v-model" class="header-anchor">#</a> 1.3.3 ä½¿ç”¨ computed æ”¹å†™è‡ªå®šä¹‰ v-model</h3> <p>åœ¨è‡ªå®šä¹‰ç»„ä»¶ä¸­åˆ›å»º <code>v-model</code> åŠŸèƒ½çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ <code>computed</code> property çš„åŠŸèƒ½æ¥å®šä¹‰ getter å’Œ setterã€‚</p> <p>ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è®¡ç®—å±æ€§é‡æ„ <code>&lt;custom-input&gt;</code> ç»„ä»¶ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'custom-input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'modelValue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;input v-model=&quot;value&quot;&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modelValue
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'update:modelValue'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æ³¨æ„ä¸¤ç‚¹ï¼š</p> <ul><li><code>get</code> æ–¹æ³•åº”è¿”å› <code>modelValue</code> propertyï¼Œæˆ–ç”¨äºç»‘å®šçš„ä»»ä½• property</li> <li><code>set</code> æ–¹æ³•åº”ä¸ºè¯¥ property è§¦å‘ç›¸åº”çš„ <code>$emit</code></li></ul> <h2 id="_1-4-ç»„ä»¶åŸºç¡€"><a href="#_1-4-ç»„ä»¶åŸºç¡€" class="header-anchor">#</a> 1.4 ç»„ä»¶åŸºç¡€</h2> <h3 id="è§£æ-dom-æ¨¡ç‰ˆæ—¶çš„æ³¨æ„äº‹é¡¹"><a href="#è§£æ-dom-æ¨¡ç‰ˆæ—¶çš„æ³¨æ„äº‹é¡¹" class="header-anchor">#</a> è§£æ DOM æ¨¡ç‰ˆæ—¶çš„æ³¨æ„äº‹é¡¹</h3> <p>æœ‰äº› HTML å…ƒç´ ï¼Œè¯¸å¦‚ <code>&lt;ul&gt;</code>ã€<code>&lt;ol&gt;</code>ã€<code>&lt;table&gt;</code> å’Œ <code>&lt;select&gt;</code>ï¼Œå¯¹äºå“ªäº›å…ƒç´ å¯ä»¥å‡ºç°åœ¨å…¶å†…éƒ¨æ˜¯æœ‰ä¸¥æ ¼é™åˆ¶çš„ã€‚è€Œæœ‰äº›å…ƒç´ ï¼Œè¯¸å¦‚ <code>&lt;li&gt;</code>ã€<code>&lt;tr&gt;</code> å’Œ <code>&lt;option&gt;</code>ï¼Œåªèƒ½å‡ºç°åœ¨å…¶å®ƒæŸäº›ç‰¹å®šçš„å…ƒç´ å†…éƒ¨ã€‚</p> <p>è¿™ä¼šå¯¼è‡´æˆ‘ä»¬ä½¿ç”¨è¿™äº›æœ‰çº¦æŸæ¡ä»¶çš„å…ƒç´ æ—¶é‡åˆ°ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blog-post-row</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blog-post-row</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>è¿™ä¸ªè‡ªå®šä¹‰ç»„ä»¶ <code>&lt;blog-post-row&gt;</code> ä¼šè¢«ä½œä¸ºæ— æ•ˆçš„å†…å®¹æå‡åˆ°å¤–éƒ¨ï¼Œå¹¶å¯¼è‡´æœ€ç»ˆæ¸²æŸ“ç»“æœå‡ºé”™ã€‚</p> <p>ä½†æˆ‘ä»¬æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ <code>v-is</code> attribute ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå˜é€šçš„åŠæ³•ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">v-is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>blog-post-row<span class="token punctuation">'</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>æ³¨æ„ï¼š</p> <p><code>v-is</code> å€¼åº”è¯¥ä¸º JavaScript å­—ç¬¦ä¸²æ–‡æœ¬ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- é”™è¯¯çš„ï¼Œè¿™æ ·ä¸ä¼šæ¸²æŸ“ä»»ä½•ä¸œè¥¿ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">v-is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blog-post-row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- æ­£ç¡®çš„ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">v-is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>blog-post-row<span class="token punctuation">'</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></blockquote> <blockquote><p>Vue2 ä¸­æ˜¯ <code>is</code> attribute</p> <p>ä¾‹å¦‚ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blog-post-row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></blockquote> <p>å¦å¤–ï¼ŒHTML å±æ€§åä¸åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤æµè§ˆå™¨å°†æŠŠæ‰€æœ‰å¤§å†™å­—ç¬¦è§£é‡Šä¸ºå°å†™ã€‚è¿™æ„å‘³ç€å½“ä½ åœ¨ DOM æ¨¡æ¿ä¸­ä½¿ç”¨æ—¶ï¼Œé©¼å³° prop åç§°å’Œ event å¤„ç†å™¨å‚æ•°éœ€è¦ä½¿ç”¨å®ƒä»¬çš„ kebab-cased (æ¨ªçº¿å­—ç¬¦åˆ†éš”) ç­‰æ•ˆå€¼ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//  åœ¨JavaScriptä¸­çš„é©¼å³°</span>

app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'blog-post'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'postTitle'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;h3&gt;{{ postTitle }}&lt;/h3&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- åœ¨HTMLåˆ™æ˜¯æ¨ªçº¿å­—ç¬¦åˆ†å‰² --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blog-post</span> <span class="token attr-name">post-title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hello!<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blog-post</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h1 id="_2-ç»„ä»¶æ·±å…¥"><a href="#_2-ç»„ä»¶æ·±å…¥" class="header-anchor">#</a> 2. ç»„ä»¶æ·±å…¥</h1> <h2 id="_2-1-é-prop-çš„-attribute"><a href="#_2-1-é-prop-çš„-attribute" class="header-anchor">#</a> 2.1 é Prop çš„ Attribute</h2> <p>ä¸€ä¸ªé prop çš„ attribute æ˜¯æŒ‡ï¼š</p> <p>ä¼ å‘ä¸€ä¸ªç»„ä»¶ï¼Œä½†æ˜¯è¯¥ç»„ä»¶å¹¶æ²¡æœ‰ç›¸åº” props æˆ– emits å®šä¹‰çš„ attributeã€‚å¸¸è§çš„ç¤ºä¾‹åŒ…æ‹¬ <code>class</code>ã€<code>style</code> å’Œ <code>id</code> å±æ€§ã€‚</p> <h3 id="_2-1-1-attribute-ç»§æ‰¿"><a href="#_2-1-1-attribute-ç»§æ‰¿" class="header-anchor">#</a> 2.1.1 Attribute ç»§æ‰¿</h3> <p>å½“ç»„ä»¶è¿”å›å•ä¸ªæ ¹èŠ‚ç‚¹æ—¶ï¼Œé prop attribute å°†è‡ªåŠ¨æ·»åŠ åˆ°æ ¹èŠ‚ç‚¹çš„ attribute ä¸­ã€‚</p> <p>ä¾‹å¦‚ï¼Œåœ¨ <code>&lt;date-picker&gt;</code> ç»„ä»¶çš„å®ä¾‹ä¸­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'date-picker'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;date-picker&quot;&gt;
      &lt;input type=&quot;datetime&quot; /&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚æœæˆ‘ä»¬éœ€è¦é€šè¿‡ <code>data status</code> property å®šä¹‰ <code>&lt;date-picker&gt;</code> ç»„ä»¶çš„çŠ¶æ€ï¼Œå®ƒå°†ä¼šåº”ç”¨äºæ ¹èŠ‚ç‚¹ (å³ <code>div.date-picker</code>)ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- å…·æœ‰éprop attributeçš„Date-pickerç»„ä»¶ï¼Œç»™å…¶ä¼ é€’data-status property --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>date-picker</span> <span class="token attr-name">data-status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>activated<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>date-picker</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- æ¸²æŸ“ date-picker ç»„ä»¶æ—¶ï¼Œdata-status property å°†åº”ç”¨äºæ ¹èŠ‚ç‚¹ä¸Šï¼Œå¦‚ä¸‹ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date-picker<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>activated<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>åŒæ ·çš„è§„åˆ™é€‚ç”¨äºäº‹ä»¶ç›‘å¬å™¨ <code>v-on</code> ç­‰ã€‚</p> <h3 id="_2-1-2-ç¦ç”¨-attribute-ç»§æ‰¿"><a href="#_2-1-2-ç¦ç”¨-attribute-ç»§æ‰¿" class="header-anchor">#</a> 2.1.2 ç¦ç”¨ Attribute ç»§æ‰¿</h3> <p>å¦‚æœä½ ä¸å¸Œæœ›ç»„ä»¶çš„æ ¹å…ƒç´ ç»§æ‰¿ attributeï¼Œä½ å¯ä»¥åœ¨ç»„ä»¶çš„é€‰é¡¹ä¸­è®¾ç½® <code>inheritAttrs: false</code>ã€‚ç¦ç”¨ attribute ç»§æ‰¿çš„å¸¸è§æƒ…å†µæ˜¯éœ€è¦å°† attribute åº”ç”¨äºæ ¹èŠ‚ç‚¹ä¹‹å¤–çš„å…¶ä»–å…ƒç´ ã€‚</p> <p>é€šè¿‡å°† <code>inheritAttrs</code> é€‰é¡¹è®¾ç½®ä¸º <code>false</code>ï¼Œä½ å¯ä»¥è®¿é—®ç»„ä»¶çš„ <code>$attrs</code> propertyï¼Œè¯¥ property åŒ…æ‹¬ç»„ä»¶ <code>props</code> å’Œ <code>emits</code> property ä¸­æœªåŒ…å«çš„æ‰€æœ‰å±æ€§ (ä¾‹å¦‚ï¼Œ<code>class</code>ã€<code>style</code>ã€<code>v-on</code> ç›‘å¬å™¨ç­‰)ã€‚</p> <p>æ”¹å†™ä¸Šé¢ä¾‹å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'date-picker'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  inheritAttrs<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class=&quot;date-picker&quot;&gt;
      &lt;input type=&quot;datetime&quot; v-bind=&quot;$attrs&quot; /&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä¸Šé¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ç»„ä»¶çš„é€‰é¡¹ä¸­è®¾ç½®äº† <code>inheritAttrs: false</code>ï¼Œå¹¶ä¸”åœ¨ <code>&lt;input&gt;</code> ä¸Šæ·»åŠ äº† <code>v-bind:&quot;$attrs&quot;</code>ï¼Œé‚£ä¹ˆ <code>data-status</code> attribute å°†åº”ç”¨äº <code>&lt;input&gt;</code> ä¸Šï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- Date-picker ç»„ä»¶ ä½¿ç”¨é prop attribute --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>date-picker</span> <span class="token attr-name">data-status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>activated<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>date-picker</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- æ¸²æŸ“ date-picker ç»„ä»¶ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date-picker<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>activated<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_2-1-3-å¤šä¸ªæ ¹èŠ‚ç‚¹ä¸Šçš„-attribute-ç»§æ‰¿"><a href="#_2-1-3-å¤šä¸ªæ ¹èŠ‚ç‚¹ä¸Šçš„-attribute-ç»§æ‰¿" class="header-anchor">#</a> 2.1.3 å¤šä¸ªæ ¹èŠ‚ç‚¹ä¸Šçš„ Attribute ç»§æ‰¿</h3> <p>ä¸å•ä¸ªæ ¹èŠ‚ç‚¹ç»„ä»¶ä¸åŒï¼Œå…·æœ‰å¤šä¸ªæ ¹èŠ‚ç‚¹çš„ç»„ä»¶ä¸å…·æœ‰<code>è‡ªåŠ¨ attribute å›é€€è¡Œä¸º</code>ã€‚å¦‚æœæœªæ˜¾å¼ç»‘å®š <code>$attrs</code>ï¼Œå°†å‘å‡ºè¿è¡Œæ—¶è­¦å‘Šã€‚</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-layout</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-layout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeValue<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>custom-layout</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¿™å°†å‘å‡ºè­¦å‘Š</span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'custom-layout'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;header&gt;...&lt;/header&gt;
    &lt;main&gt;...&lt;/main&gt;
    &lt;footer&gt;...&lt;/footer&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// æ²¡æœ‰è­¦å‘Šï¼Œ$attrsè¢«ä¼ é€’åˆ°&lt;main&gt;å…ƒç´ </span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'custom-layout'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;header&gt;...&lt;/header&gt;
    &lt;main v-bind=&quot;$attrs&quot;&gt;...&lt;/main&gt;
    &lt;footer&gt;...&lt;/footer&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_2-2-è‡ªå®šä¹‰äº‹ä»¶"><a href="#_2-2-è‡ªå®šä¹‰äº‹ä»¶" class="header-anchor">#</a> 2.2 è‡ªå®šä¹‰äº‹ä»¶</h2> <h3 id="_2-2-1-äº‹ä»¶å"><a href="#_2-2-1-äº‹ä»¶å" class="header-anchor">#</a> 2.2.1 äº‹ä»¶å</h3> <p>ä¸åŒäºç»„ä»¶å’Œ propï¼Œäº‹ä»¶åä¸å­˜åœ¨ä»»ä½•è‡ªåŠ¨åŒ–çš„å¤§å°å†™è½¬æ¢ã€‚è€Œæ˜¯è§¦å‘çš„äº‹ä»¶åéœ€è¦å®Œå…¨åŒ¹é…ç›‘å¬è¿™ä¸ªäº‹ä»¶æ‰€ç”¨çš„åç§°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœè§¦å‘ä¸€ä¸ª camelCase åå­—çš„äº‹ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'myEvent'</span><span class="token punctuation">)</span>
</code></pre></div><p>åˆ™ç›‘å¬è¿™ä¸ªåå­—çš„ kebab-case ç‰ˆæœ¬æ˜¯ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœçš„ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- æ²¡æœ‰æ•ˆæœ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-component</span> <span class="token attr-name">@my-event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>doSomething<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-component</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä¸åŒäºç»„ä»¶å’Œ propï¼Œäº‹ä»¶åä¸ä¼šè¢«ç”¨ä½œä¸€ä¸ª JavaScript å˜é‡åæˆ– property åï¼Œæ‰€ä»¥å°±æ²¡æœ‰ç†ç”±ä½¿ç”¨ camelCase æˆ– PascalCase äº†ã€‚</p> <p>å¹¶ä¸” <code>v-on</code> äº‹ä»¶ç›‘å¬å™¨åœ¨ DOM æ¨¡æ¿ä¸­ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºå…¨å°å†™ (å› ä¸º HTML æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„)ï¼Œæ‰€ä»¥ <code>@myEvent</code> å°†ä¼šå˜æˆ <code>@myevent</code>â€”â€”å¯¼è‡´ <code>myEvent</code> ä¸å¯èƒ½è¢«ç›‘å¬åˆ°ã€‚</p> <p>å› æ­¤ï¼Œäº‹ä»¶åéƒ½æ¨èå§‹ç»ˆä½¿ç”¨ <code>kebab-case</code> äº‹ä»¶åã€‚</p> <h3 id="_2-2-2-å®šä¹‰è‡ªå®šä¹‰äº‹ä»¶"><a href="#_2-2-2-å®šä¹‰è‡ªå®šä¹‰äº‹ä»¶" class="header-anchor">#</a> 2.2.2 å®šä¹‰è‡ªå®šä¹‰äº‹ä»¶</h3> <p>é€šè¿‡ <code>emits</code> é€‰é¡¹åœ¨ç»„ä»¶ä¸Šå®šä¹‰å·²å‘å‡ºçš„äº‹ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'custom-form'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  emits<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'in-focus'</span><span class="token punctuation">,</span> <span class="token string">'submit'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>Vue2 ä¸­æ²¡æœ‰ emits é€‰é¡¹</p></blockquote> <p>å½“åœ¨ <code>emits</code> é€‰é¡¹ä¸­å®šä¹‰äº†åŸç”Ÿäº‹ä»¶ (å¦‚ <code>click</code>) æ—¶ï¼Œå°†ä½¿ç”¨è¯¥äº‹ä»¶<strong>æ›¿ä»£</strong>åŸç”Ÿäº‹ä»¶ä¾¦å¬å™¨ã€‚</p> <blockquote><p>å»ºè®®å®šä¹‰æ‰€æœ‰å‘å‡ºçš„äº‹ä»¶ï¼Œä»¥ä¾¿æ›´å¥½åœ°è®°å½•ç»„ä»¶åº”è¯¥å¦‚ä½•å·¥ä½œã€‚</p></blockquote> <h4 id="éªŒè¯æŠ›å‡ºçš„äº‹ä»¶"><a href="#éªŒè¯æŠ›å‡ºçš„äº‹ä»¶" class="header-anchor">#</a> éªŒè¯æŠ›å‡ºçš„äº‹ä»¶</h4> <p>ä¸ prop ç±»å‹éªŒè¯ç±»ä¼¼ï¼Œå¦‚æœä½¿ç”¨<code>å¯¹è±¡è¯­æ³•</code>è€Œä¸æ˜¯æ•°ç»„è¯­æ³•å®šä¹‰å‘å‡ºçš„äº‹ä»¶ï¼Œåˆ™å¯ä»¥éªŒè¯å®ƒã€‚</p> <p>è‹¥è¦æ·»åŠ éªŒè¯ï¼Œåˆ™éœ€ä¸ºäº‹ä»¶åˆ†é…ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°<code>æ¥æ”¶</code>ä¼ é€’ç»™ <code>$emit</code> è°ƒç”¨çš„å‚æ•°ï¼Œå¹¶<code>è¿”å›</code>ä¸€ä¸ªå¸ƒå°”å€¼ä»¥æŒ‡ç¤ºäº‹ä»¶æ˜¯å¦æœ‰æ•ˆã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'custom-form'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  emits<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ²¡æœ‰éªŒè¯</span>
    click<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>

    <span class="token comment">// éªŒè¯submit äº‹ä»¶</span>
    <span class="token function-variable function">submit</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>email <span class="token operator">&amp;&amp;</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Invalid submit event payload!'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-2-3-v-model-å‚æ•°"><a href="#_2-2-3-v-model-å‚æ•°" class="header-anchor">#</a> 2.2.3 <code>v-model</code> å‚æ•°</h3> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç»„ä»¶ä¸Šçš„ <code>v-model</code> ä½¿ç”¨ <code>modelValue</code> ä½œä¸º prop å’Œ <code>update:modelValue</code> ä½œä¸ºäº‹ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘ <code>v-model</code> ä¼ é€’å‚æ•°æ¥<code>ä¿®æ”¹è¿™äº›åç§°</code>ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-component</span> <span class="token attr-name"><span class="token namespace">v-model:</span>foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-component</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œå­ç»„ä»¶å°†éœ€è¦ä¸€ä¸ª <code>foo</code> çš„ propï¼Œå¹¶å‘å‡º <code>update:foo</code> è¿™ä¸ªè¦åŒæ­¥çš„äº‹ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'my-component'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> String
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;input 
      type=&quot;text&quot;
      :value=&quot;foo&quot;
      @input=&quot;$emit('update:foo', $event.target.value)&quot;&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-component</span> <span class="token attr-name"><span class="token namespace">v-model:</span>foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-component</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_2-2-4-å¤šä¸ª-v-model-ç»‘å®š"><a href="#_2-2-4-å¤šä¸ª-v-model-ç»‘å®š" class="header-anchor">#</a> 2.2.4 å¤šä¸ª <code>v-model</code> ç»‘å®š</h3> <p>é€šè¿‡ v-model çš„å‚æ•°ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨å•ä¸ªç»„ä»¶å®ä¾‹ä¸Šåˆ›å»º<code>å¤šä¸ª</code> v-model ç»‘å®šã€‚</p> <blockquote><p>Vue2 çš„ç»„ä»¶ä¸æ”¯æŒå¤šä¸ª v-model ç»‘å®š</p></blockquote> <p>æ¯ä¸ª v-model å°†åŒæ­¥åˆ°ä¸åŒçš„ propï¼Œè€Œä¸éœ€è¦åœ¨ç»„ä»¶ä¸­æ·»åŠ é¢å¤–çš„é€‰é¡¹ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user-name</span>
  <span class="token attr-name"><span class="token namespace">v-model:</span>first-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>firstName<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">v-model:</span>last-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lastName<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user-name</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'user-name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    firstName<span class="token operator">:</span> String<span class="token punctuation">,</span>
    lastName<span class="token operator">:</span> String
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;input 
      type=&quot;text&quot;
      :value=&quot;firstName&quot;
      @input=&quot;$emit('update:firstName', $event.target.value)&quot;&gt;

    &lt;input
      type=&quot;text&quot;
      :value=&quot;lastName&quot;
      @input=&quot;$emit('update:lastName', $event.target.value)&quot;&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_2-3-å¼‚æ­¥ç»„ä»¶"><a href="#_2-3-å¼‚æ­¥ç»„ä»¶" class="header-anchor">#</a> 2.3 å¼‚æ­¥ç»„ä»¶</h2> <h3 id="_2-3-1-åŸºæœ¬ä½¿ç”¨"><a href="#_2-3-1-åŸºæœ¬ä½¿ç”¨" class="header-anchor">#</a> 2.3.1 åŸºæœ¬ä½¿ç”¨</h3> <p>åœ¨å¤§å‹åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å°†åº”ç”¨åˆ†å‰²æˆå°ä¸€äº›çš„ä»£ç å—ï¼Œå¹¶ä¸”åªåœ¨éœ€è¦çš„æ—¶å€™æ‰ä»æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªæ¨¡å—ã€‚ä¸ºäº†ç®€åŒ–ï¼ŒVue æœ‰ä¸€ä¸ª <code>defineAsyncComponent</code> æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> AsyncComp <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        template<span class="token operator">:</span> <span class="token string">'&lt;div&gt;I am async!&lt;/div&gt;'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'async-example'</span><span class="token punctuation">,</span> AsyncComp<span class="token punctuation">)</span>
</code></pre></div><p>æ­¤æ–¹æ³•æ¥å—è¿”å› <code>Promise</code> çš„å·¥å‚å‡½æ•°ã€‚ä»æœåŠ¡å™¨æ£€ç´¢ç»„ä»¶å®šä¹‰åï¼Œåº”è°ƒç”¨ Promise çš„ <code>resolve</code> å›è°ƒã€‚ä½ ä¹Ÿå¯ä»¥è°ƒç”¨ <code>reject(reason)</code>ï¼Œä»¥æŒ‡ç¤ºåŠ è½½å¤±è´¥ã€‚</p> <p>ä½ ä¹Ÿå¯ä»¥åœ¨å·¥å‚å‡½æ•°ä¸­è¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œæ‰€ä»¥æŠŠ webpack 2 å’Œ ES2015 è¯­æ³•åŠ åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨åŠ¨æ€å¯¼å…¥ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineAsyncComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> AsyncComp <span class="token operator">=</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./components/AsyncComponent.vue'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'async-component'</span><span class="token punctuation">,</span> AsyncComp<span class="token punctuation">)</span>
</code></pre></div><p>åœ¨æœ¬åœ°æ³¨å†Œç»„ä»¶æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>defineAsyncComponent</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp<span class="token punctuation">,</span> defineAsyncComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    AsyncComponent<span class="token operator">:</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./components/AsyncComponent.vue'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>Vue2 ä¸­æ˜¯å°†å¼‚æ­¥ç»„ä»¶å’Œ webpack çš„ code-splitting ç»“åˆæˆ–è€…ç›´æ¥ä½¿ç”¨åŠ¨æ€å¯¼å…¥</p></blockquote> <h3 id="_2-3-2-ä¸suspense-ä¸€èµ·ä½¿ç”¨"><a href="#_2-3-2-ä¸suspense-ä¸€èµ·ä½¿ç”¨" class="header-anchor">#</a> 2.3.2 ä¸Suspense ä¸€èµ·ä½¿ç”¨</h3> <p>è¯¦æƒ…è§å†…ç½®ç»„ä»¶ä¸­çš„ Suspense</p> <h1 id="_3-å†…ç½®ç»„ä»¶"><a href="#_3-å†…ç½®ç»„ä»¶" class="header-anchor">#</a> 3. å†…ç½®ç»„ä»¶</h1> <h2 id="_3-1-teleport"><a href="#_3-1-teleport" class="header-anchor">#</a> 3.1 Teleport</h2> <p><code>Teleport</code> æ„ä¸ºç¬é—´ç§»åŠ¨ã€‚Teleport æä¾›äº†ä¸€ç§å¹²å‡€çš„æ–¹æ³•ï¼Œå…è®¸æˆ‘ä»¬æ§åˆ¶åœ¨ DOM ä¸­å“ªä¸ªçˆ¶èŠ‚ç‚¹ä¸‹å‘ˆç° HTMLï¼Œè€Œä¸å¿…æ±‚åŠ©äºå…¨å±€çŠ¶æ€æˆ–å°†å…¶æ‹†åˆ†ä¸ºä¸¤ä¸ªç»„ä»¶ã€‚</p> <p>å½“æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªå¼¹çª—ç»„ä»¶æ—¶ï¼Œä¼šé‡åˆ°å‡ ç‚¹é—®é¢˜ï¼š</p> <ul><li>è¢«åŒ…è£¹åœ¨å…¶ä»–ç»„ä»¶ä¸­ï¼Œå®¹æ˜“è¢«å¹²æ‰°</li> <li>æ ·å¼ä¹Ÿåœ¨å…¶ä»–ç»„ä»¶ä¸­ï¼Œå®¹æ˜“å˜å¾—éå¸¸æ··ä¹±</li></ul> <p>æˆ‘ä»¬ä¼šå¸Œæœ›è¿™ä¸ªå¼¹çª—ç»„ä»¶èƒ½ç›´æ¥å‡ºç°åœ¨é¡¶å±‚ DOM èŠ‚ç‚¹ä¸Šï¼Œè€Œä¸ç”¨åµŒå¥—åœ¨å¾ˆæ·±å±‚çº§çš„ DOM ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ° Teleportã€‚</p> <p>Teleport å¯ä»¥å»ºç«‹ä¸€ä¸ªä¼ é€é—¨ï¼ŒTeleport åŒ…è£¹çš„ç»„ä»¶åœ¨è¡¨ç°å±‚å’Œå…¶ä»–ç»„ä»¶æ²¡æœ‰ä»»ä½•å·®å¼‚ï¼Œä½†æ¸²æŸ“çš„ç»“æœå´åƒç»è¿‡ä¸€ä¸ªä¼ é€é—¨ä¸€æ ·å‡ºç°åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹ã€‚</p> <p>ä»¥ä¸‹æ˜¯ç¤ºä¾‹ã€‚</p> <p>åœ¨ <code>components/Modal.vue</code> ä¸­ï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- è¿™é‡Œä¼šè½¬ç§»åˆ° id ä¸º modal çš„ DOM ä¸Š --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>teleport</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#modal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isOpen<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>this is a modal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>buttonClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>close<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>teleport</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    isOpen<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  emits<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'close-modal'</span><span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">buttonClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'close-modal'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      buttonClick
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">#center</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 2px solid black<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> -100px<span class="token punctuation">;</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> -100px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>åœ¨çˆ¶ç»„ä»¶ä¸­å¼•ç”¨ Modal ç»„ä»¶ï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modal</span> <span class="token attr-name">:isOpen</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modalIsOpen<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@close-modal</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onModalClose<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>this is a modal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modal</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>openModal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>open modal<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Modal <span class="token keyword">from</span> <span class="token string">'../components/Modal.vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    Modal
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> modalIsOpen <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">openModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      modalIsOpen<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token function-variable function">onModalClose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      modalIsOpen<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      modalIsOpen<span class="token punctuation">,</span>
      openModal<span class="token punctuation">,</span>
      onModalClose<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä½¿ç”¨ teleport åŒ…è£¹ç»„ä»¶ï¼Œteleport ä¸Šé¢æœ‰ä¸€ä¸ª to çš„å±æ€§ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª CSS querySelector ä½œä¸ºå‚æ•°ï¼Œæ„ä¸ºè¦æŠŠè¿™ä¸ªç»„ä»¶æ¸²æŸ“åˆ°å“ªä¸ª DOM ä¸Šé¢å»ã€‚æˆ‘ä»¬æœ€å¥½å°†æ¨¡æ¿çš„è¿™ä¸€éƒ¨åˆ†ç§»åŠ¨åˆ° DOM ä¸­ Vue app ä¹‹å¤–çš„å…¶ä»–ä½ç½®ã€‚</p> <blockquote><p>ä½¿ç”¨ emits çš„ä½œç”¨ï¼š</p> <ul><li>å¯ä»¥æ›´æ˜ç¡®çš„æ˜¾ç¤ºç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶æœ‰å“ªäº›</li> <li>æ”¯æŒè¿è¡Œæ—¶çš„æ£€éªŒï¼Œæ¥æ”¶ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°ï¼Œå¯ä»¥éªŒè¯å‘é€çš„å‚æ•°æ˜¯å¦æ­£ç¡®</li> <li>æ”¯æŒç±»å‹æ¨è®ºï¼Œè‡ªåŠ¨è¡¥å…¨</li> <li>å°†æ¥è¿˜ä¼šæ”¯æŒ IDE ä¸­æ¨¡ç‰ˆçš„è‡ªåŠ¨è¡¥å…¨</li></ul></blockquote> <h2 id="_3-2-suspense"><a href="#_3-2-suspense" class="header-anchor">#</a> 3.2 Suspense</h2> <p><code>Suspense</code> æ˜¯å¼‚æ­¥è¯·æ±‚çš„å¥½å¸®æ‰‹ã€‚</p> <p>åœ¨å‘èµ·å¼‚æ­¥è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦åˆ¤æ–­è¿™äº›å¼‚æ­¥è¯·æ±‚çš„çŠ¶æ€ï¼Œæ ¹æ®è¿™äº›è¯·æ±‚æ˜¯å¦å®Œæ¯•æ¥å±•ç¤ºä¸åŒçš„ç•Œé¢ã€‚</p> <p>Suspense æœ‰ä¸¤ä¸ª template slot ï¼Œåˆšå¼€å§‹ä¼šæ¸²æŸ“ä¸€ä¸ª fallback å†…å®¹ï¼Œç›´åˆ°è¾¾åˆ°æŸä¸ªæ¡ä»¶ä»¥åï¼Œæ‰ä¼šæ¸²æŸ“æ­£å¼çš„å†…å®¹ï¼ˆdefaultï¼‰ã€‚è¿™æ ·æ¥è¿›è¡Œå¼‚æ­¥æ¸²æŸ“ï¼Œå°±ä¼šå˜å¾—éå¸¸çš„ç®€å•ã€‚</p> <blockquote><p>ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœè¦ä½¿ç”¨ Suspenseï¼Œé‚£ä¹ˆåœ¨ setup() ä¸­ï¼Œæˆ‘ä»¬è¦è¿”å›ä¸€ä¸ª Promiseï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚</p></blockquote> <p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ã€‚</p> <p>å…ˆå†™ä¸€ä¸ªå¼‚æ­¥çš„ç»„ä»¶ï¼Œåœ¨ <code>components/AsyncShow.vue</code> ä¸­ï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>{{ result }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          result<span class="token operator">:</span> <span class="token number">42</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>è¿™ä¸ªå¼‚æ­¥ç»„ä»¶ï¼Œä¸‰ç§’åè¿”å›ä¸€ä¸ªæ•°å­—ï¼Œä¸”ä¸ºä¸€ä¸ª Promise å¯¹è±¡</p> <p>åœ¨ç»„ä»¶ä¸­å¼•ç”¨å®ƒï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Suspense</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- å…ˆå±•ç¤ºçš„ fallback å†…å®¹ --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#fallback</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Loading ...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- resolve åå±•ç¤ºçš„å†…å®¹ --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>async-show</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>async-show</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Suspense</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ error }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> onErrorCaptured<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> AsyncShow <span class="token keyword">from</span> <span class="token string">'../components/AsyncShow.vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    AsyncShow
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token function">onErrorCaptured</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      error<span class="token punctuation">.</span>value <span class="token operator">=</span> e
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      error
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä¸å¼‚æ­¥ç»„ä»¶ç›¸ä¼¼ï¼ŒSuspense ä¹Ÿå®Œç¾æ”¯æŒå¼‚æ­¥ç»„ä»¶ã€‚æ€»ä¹‹ï¼ŒSuspense ç»„ä»¶å¯ä»¥ä¸ºå¼‚æ­¥è¯·æ±‚çš„ç•Œé¢è¿›è¡Œä¸ªæ€§åŒ–çš„å®šåˆ¶ã€‚</p> <blockquote><p>è‹¥è¦æŠ“å–é”™è¯¯ï¼Œå¯ä½¿ç”¨ onErrorCaptured é’©å­å‡½æ•°ï¼Œè¿™ä¸ªé’©å­å‡½æ•°è¦è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å‘ä¸Šä¼ æ’­ã€‚</p></blockquote> <h1 id="_4-å“åº”æ€§"><a href="#_4-å“åº”æ€§" class="header-anchor">#</a> 4. å“åº”æ€§</h1> <h2 id="_4-1-å“åº”æ€§åŸç†"><a href="#_4-1-å“åº”æ€§åŸç†" class="header-anchor">#</a> 4.1 å“åº”æ€§åŸç†</h2> <p>åœ¨ vue2 ä¸­ï¼Œé€šè¿‡ <code>Object.defineProperty</code> æ¥å®ç°å“åº”å¼ï¼Œä½†æ˜¯åœ¨å¯¹è±¡æ–°å¢å’Œåˆ é™¤å±æ€§æ—¶ï¼Œæˆ–æ˜¯ä¿®æ”¹æ•°ç»„é•¿åº¦ç›´æ¥é€šè¿‡ç´¢å¼•ä¿®æ”¹ä¸€ä¸ªæ•°ç»„é¡¹æ—¶ï¼Œæ— æ³•æ£€æµ‹ã€‚</p> <p>é’ˆå¯¹ä¸Šè¿°ç¼ºç‚¹ï¼Œvue3 é‡‡ç”¨äº† <code>Proxy</code> æ¥å®ç°å“åº”å¼ã€‚Proxy å¯¹è±¡ç”¨äºå®šä¹‰åŸºæœ¬æ“ä½œçš„è‡ªå®šä¹‰è¡Œä¸ºï¼ˆå¦‚å±æ€§æŸ¥æ‰¾ã€èµ‹å€¼ã€æšä¸¾ã€å‡½æ•°è°ƒç”¨ç­‰ï¼‰ã€‚</p> <p>ä»¥ä¸‹æ˜¯ä¸¤è€…çš„å¯¹æ¯”</p> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œç›¸æ¯”äº Object.definePropertyï¼ŒProxy åœ¨æ›´é«˜ç»´åº¦ä¸Šè¿›è¡Œäº†å±æ€§çš„æ‹¦æˆªä¸ä¿®æ”¹ã€‚</p> <p>åœ¨ Object.defineProperty ä¸­ï¼Œå¯¹äºç»™å®šçš„ dataï¼Œéœ€è¦ç»™å®šå…·ä½“çš„ key å€¼æ‰èƒ½è¿›è¡Œæ‹¦æˆªä¸ä¿®æ”¹ï¼Œè¿™ä¸ª key å€¼å°±æ˜¯ä¸Šè¿°ä»£ç çš„ countï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦é¢„å…ˆçŸ¥é“è¦æ‹¦æˆªçš„ key æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥å¯¹æ–°å¢çš„ key å€¼æ— èƒ½ä¸ºåŠ›ã€‚è€Œ Proxy åˆ™ä¸å…³å¿ƒæ‰€è¦æ‹¦æˆªçš„ key æ˜¯ä»€ä¹ˆï¼Œå®ƒå¯ä»¥æ‹¦æˆªå’Œä¿®æ”¹ data ä¸Šä»»æ„çš„ keyï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯å·²æœ‰çš„ key è¿˜æ˜¯æ–°å¢çš„ keyï¼ŒProxy éƒ½èƒ½å¯¹å…¶è¿›è¡Œæ‹¦æˆªå’Œä¿®æ”¹ã€‚</p> <p>Proxy æ›´å¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼Œå®ƒé™¤äº† getter å’Œ setterï¼Œè¿˜å¯ä»¥æ‹¦æˆªæ›´å¤šçš„æ“ä½œç¬¦ã€‚</p> <h2 id="_4-2-å“åº”æ€§åŸºç¡€"><a href="#_4-2-å“åº”æ€§åŸºç¡€" class="header-anchor">#</a> 4.2 å“åº”æ€§åŸºç¡€</h2> <h3 id="_4-2-1-å£°æ˜å“åº”å¼çŠ¶æ€"><a href="#_4-2-1-å£°æ˜å“åº”å¼çŠ¶æ€" class="header-anchor">#</a> 4.2.1 å£°æ˜å“åº”å¼çŠ¶æ€</h3> <p>è¦ä¸º JavaScript å¯¹è±¡åˆ›å»ºå“åº”å¼çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨ <code>reactive</code> æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// å“åº”å¼çŠ¶æ€</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  count<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p><code>reactive</code> ç›¸å½“äº Vue 2.x ä¸­çš„ <code>Vue.observable()</code> API ï¼Œä¸ºé¿å…ä¸ RxJS ä¸­çš„ observables æ··æ·†å› æ­¤å¯¹å…¶é‡å‘½åã€‚è¯¥ API è¿”å›ä¸€ä¸ªå“åº”å¼çš„å¯¹è±¡çŠ¶æ€ã€‚è¯¥å“åº”å¼è½¬æ¢æ˜¯â€œæ·±åº¦è½¬æ¢â€â€”â€”å®ƒä¼šå½±å“åµŒå¥—å¯¹è±¡ä¼ é€’çš„æ‰€æœ‰ propertyã€‚</p></blockquote> <p>è¿™å°±æ˜¯ Vue å“åº”æ€§ç³»ç»Ÿçš„æœ¬è´¨ã€‚å½“ä»ç»„ä»¶ä¸­çš„ <code>data()</code> è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå®ƒåœ¨å†…éƒ¨äº¤ç”± <code>reactive()</code> ä½¿å…¶æˆä¸ºå“åº”å¼å¯¹è±¡ã€‚æ¨¡æ¿ä¼šè¢«ç¼–è¯‘æˆèƒ½å¤Ÿä½¿ç”¨è¿™äº›å“åº”å¼ property çš„æ¸²æŸ“å‡½æ•°ã€‚</p> <h3 id="_4-2-2-åˆ›å»ºç‹¬ç«‹çš„å“åº”å¼å€¼ä½œä¸º-refs"><a href="#_4-2-2-åˆ›å»ºç‹¬ç«‹çš„å“åº”å¼å€¼ä½œä¸º-refs" class="header-anchor">#</a> 4.2.2 åˆ›å»ºç‹¬ç«‹çš„å“åº”å¼å€¼ä½œä¸º <code>refs</code></h3> <p>æˆ‘ä»¬æœ‰ä¸€ä¸ªç‹¬ç«‹çš„åŸå§‹å€¼ (ä¾‹å¦‚ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²)ï¼Œæˆ‘ä»¬æƒ³è®©å®ƒå˜æˆå“åº”å¼çš„ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰ç›¸åŒå­—ç¬¦ä¸² property çš„å¯¹è±¡ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ <code>reactive</code>ã€‚</p> <p>ä½† Vue3 ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¯ä»¥åšç›¸åŒäº‹æƒ…çš„æ–¹æ³• â€”â€”<code>ref</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><p><code>ref</code> ä¼šè¿”å›ä¸€ä¸ªå¯å˜çš„å“åº”å¼å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä½œä¸ºå®ƒçš„å†…éƒ¨å€¼â€”â€”ä¸€ä¸ª<strong>å“åº”å¼çš„å¼•ç”¨</strong>ï¼Œè¿™å°±æ˜¯åç§°çš„æ¥æºã€‚æ­¤å¯¹è±¡åªåŒ…å«ä¸€ä¸ªåä¸º <code>value</code> çš„ propertyï¼Œé€šè¿‡ value è¿™ä¸ªå±æ€§æ‰èƒ½å–åˆ°å®ƒçš„å€¼ ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 0</span>

count<span class="token punctuation">.</span>value<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><h4 id="refå±•å¼€"><a href="#refå±•å¼€" class="header-anchor">#</a> refå±•å¼€</h4> <p>å½“ ref ä½œä¸ºæ¸²æŸ“ä¸Šä¸‹æ–‡ (ä» setup() ä¸­è¿”å›çš„å¯¹è±¡ï¼‰ä¸Šçš„ property è¿”å›å¹¶å¯ä»¥åœ¨æ¨¡ç‰ˆä¸­è¢«è®¿é—®æ—¶ï¼Œå®ƒå°†è‡ªåŠ¨å±•å¼€ä¸ºå†…éƒ¨å€¼ï¼Œè€Œä¸éœ€è¦åœ¨æ¨¡ç‰ˆä¸­è¿½åŠ  <code>.value</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count ++<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Increment count<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        count
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="è®¿é—®å“åº”å¼å¯¹è±¡"><a href="#è®¿é—®å“åº”å¼å¯¹è±¡" class="header-anchor">#</a> è®¿é—®å“åº”å¼å¯¹è±¡</h4> <p>å½“ <code>ref</code> ä½œä¸ºå“åº”å¼å¯¹è±¡ï¼ˆreactiveï¼‰çš„ property è¢«è®¿é—®æˆ–æ›´æ”¹æ—¶ï¼Œä¸ºä½¿å…¶è¡Œä¸ºç±»ä¼¼äºæ™®é€š propertyï¼Œå®ƒä¼šè‡ªåŠ¨å±•å¼€å†…éƒ¨å€¼ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  count
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// 0</span>

state<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><p>å¦‚æœå°†æ–°çš„ ref èµ‹å€¼ç»™ç°æœ‰ ref çš„ propertyï¼Œå°†ä¼šæ›¿æ¢æ—§çš„ refï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> otherCount <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

state<span class="token punctuation">.</span>count <span class="token operator">=</span> otherCount
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><p>Ref å±•å¼€ä»…å‘ç”Ÿåœ¨è¢«å“åº”å¼ <code>Object</code> åµŒå¥—çš„æ—¶å€™ã€‚å½“ä» <code>Array</code> æˆ–åŸç”Ÿé›†åˆç±»å‹å¦‚ <code>Map</code> è®¿é—® ref æ—¶ï¼Œ<code>ä¸ä¼š</code>è¿›è¡Œå±•å¼€ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> books <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'Vue 3 Guide'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// è¿™é‡Œéœ€è¦ .value</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>books<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>

<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// è¿™é‡Œéœ€è¦ .value</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-2-3-å“åº”å¼çŠ¶æ€è§£æ„"><a href="#_4-2-3-å“åº”å¼çŠ¶æ€è§£æ„" class="header-anchor">#</a> 4.2.3 å“åº”å¼çŠ¶æ€è§£æ„</h3> <p>å½“æˆ‘ä»¬æƒ³ä½¿ç”¨å¤§å‹å“åº”å¼å¯¹è±¡çš„ä¸€äº› property æ—¶ï¼Œå¯èƒ½å¾ˆæƒ³ä½¿ç”¨ ES6 çš„è§£æ„æ¥è·å–æˆ‘ä»¬æƒ³è¦çš„ propertyï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> book <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  author<span class="token operator">:</span> <span class="token string">'Vue Team'</span><span class="token punctuation">,</span>
  year<span class="token operator">:</span> <span class="token string">'2020'</span><span class="token punctuation">,</span>
  title<span class="token operator">:</span> <span class="token string">'Vue 3 Guide'</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token string">'You are reading this book right now ;)'</span><span class="token punctuation">,</span>
  price<span class="token operator">:</span> <span class="token string">'free'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span> author<span class="token punctuation">,</span> title <span class="token punctuation">}</span> <span class="token operator">=</span> book
</code></pre></div><p>ä½†è¿™æ—¶ï¼Œä½¿ç”¨è§£æ„çš„ä¸¤ä¸ª property çš„å“åº”æ€§éƒ½ä¼šä¸¢å¤±ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬çš„å“åº”å¼å¯¹è±¡è½¬æ¢ä¸ºä¸€ç»„ refã€‚è¿™äº› ref å°†ä¿ç•™ä¸æºå¯¹è±¡çš„å“åº”å¼å…³è”ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦ç”¨åˆ° <code>toRefs</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> book <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  author<span class="token operator">:</span> <span class="token string">'Vue Team'</span><span class="token punctuation">,</span>
  year<span class="token operator">:</span> <span class="token string">'2020'</span><span class="token punctuation">,</span>
  title<span class="token operator">:</span> <span class="token string">'Vue 3 Guide'</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token string">'You are reading this book right now ;)'</span><span class="token punctuation">,</span>
  price<span class="token operator">:</span> <span class="token string">'free'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span> author<span class="token punctuation">,</span> title <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span>

title<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Vue 3 Detailed Guide'</span> <span class="token comment">// æˆ‘ä»¬éœ€è¦ä½¿ç”¨ .value ä½œä¸ºæ ‡é¢˜ï¼Œç°åœ¨æ˜¯ ref</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token comment">// 'Vue 3 Detailed Guide'</span>
</code></pre></div><h3 id="_4-2-4-ä½¿ç”¨-readonly-é˜²æ­¢æ›´æ”¹å“åº”å¼å¯¹è±¡"><a href="#_4-2-4-ä½¿ç”¨-readonly-é˜²æ­¢æ›´æ”¹å“åº”å¼å¯¹è±¡" class="header-anchor">#</a> 4.2.4 ä½¿ç”¨ <code>readonly</code> é˜²æ­¢æ›´æ”¹å“åº”å¼å¯¹è±¡</h3> <p>æœ‰æ—¶æˆ‘ä»¬æƒ³è·Ÿè¸ªå“åº”å¼å¯¹è±¡ (<code>ref</code> æˆ– <code>reactive</code>) çš„å˜åŒ–ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¸Œæœ›é˜²æ­¢åœ¨åº”ç”¨ç¨‹åºçš„æŸä¸ªä½ç½®æ›´æ”¹å®ƒã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªè¢« provide çš„å“åº”å¼å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬ä¸æƒ³è®©å®ƒåœ¨ inject çš„æ—¶å€™è¢«æ”¹å˜ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºåŸå§‹å¯¹è±¡åˆ›å»ºä¸€ä¸ªåªè¯»çš„ Proxy å¯¹è±¡ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> readonly <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> copy <span class="token operator">=</span> <span class="token function">readonly</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span>

<span class="token comment">// åœ¨copyä¸Šè½¬æ¢original ä¼šè§¦å‘ä¾¦å¬å™¨ä¾èµ–</span>
original<span class="token punctuation">.</span>count<span class="token operator">++</span>

<span class="token comment">// è½¬æ¢copy å°†å¯¼å¤±è´¥å¹¶å¯¼è‡´è­¦å‘Š</span>
copy<span class="token punctuation">.</span>count<span class="token operator">++</span> <span class="token comment">// è­¦å‘Š: &quot;Set operation on key 'count' failed: target is readonly.&quot;</span>
</code></pre></div><h2 id="_4-3-å“åº”å¼è®¡ç®—å’Œä¾¦å¬"><a href="#_4-3-å“åº”å¼è®¡ç®—å’Œä¾¦å¬" class="header-anchor">#</a> 4.3 å“åº”å¼è®¡ç®—å’Œä¾¦å¬</h2> <h3 id="_4-3-1-computed"><a href="#_4-3-1-computed" class="header-anchor">#</a> 4.3.1 computed</h3> <p>æœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¾èµ–äºå…¶ä»–çŠ¶æ€çš„çŠ¶æ€ã€‚åœ¨ Vue ä¸­ï¼Œè¿™æ˜¯ç”¨ç»„ä»¶è®¡ç®—å±æ€§å¤„ç†çš„ã€‚</p> <p>åˆ›å»ºè®¡ç®—å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>computed</code> æ–¹æ³•ï¼šå®ƒæ¥å— getter å‡½æ•°å¹¶ä¸º getter è¿”å›çš„å€¼è¿”å›ä¸€ä¸ªä¸å¯å˜çš„å“åº”å¼ ref å¯¹è±¡ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> plusOne <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>plusOne<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 2</span>

plusOne<span class="token punctuation">.</span>value<span class="token operator">++</span> <span class="token comment">// error</span>
</code></pre></div><p>æˆ–è€…ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¸¦æœ‰ <code>get</code> å’Œ <code>set</code> å‡½æ•°çš„å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå¯å†™çš„ ref å¯¹è±¡ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> plusOne <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">.</span>value <span class="token operator">=</span> val <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

plusOne<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 0</span>
</code></pre></div><h3 id="_4-3-2-watch"><a href="#_4-3-2-watch" class="header-anchor">#</a> 4.3.2 watch</h3> <p><code>watch</code> API å®Œå…¨ç­‰åŒäºç»„ä»¶ä¾¦å¬å™¨ propertyã€‚<code>watch</code> éœ€è¦ä¾¦å¬ç‰¹å®šçš„æ•°æ®æºï¼Œå¹¶åœ¨å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œå‰¯ä½œç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¹Ÿæ˜¯æƒ°æ€§çš„ï¼Œå³åªæœ‰å½“è¢«ä¾¦å¬çš„æºå‘ç”Ÿå˜åŒ–æ—¶æ‰æ‰§è¡Œå›è°ƒã€‚</p> <p>ä¾¦å¬å™¨æ•°æ®æºå¯ä»¥æ˜¯è¿”å›å€¼çš„ getter å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ˜¯ <code>ref</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä¾¦å¬ä¸€ä¸ª getter</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">count<span class="token punctuation">,</span> prevCount</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// ç›´æ¥ä¾¦å¬ref</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">watch</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">count<span class="token punctuation">,</span> prevCount</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="_5-composition-api-ç»„åˆå¼-api"><a href="#_5-composition-api-ç»„åˆå¼-api" class="header-anchor">#</a> 5. composition APIï¼ˆç»„åˆå¼ APIï¼‰</h1> <p>åœ¨ Vue2 ä¸­ï¼Œé‡‡ç”¨çš„æ˜¯ options APIï¼šæŒ‰é€‰é¡¹ç±»å‹åˆ†ç»„ã€‚</p> <p>è¿™ç§ç¢ç‰‡åŒ–ä½¿å¾—ç†è§£å’Œç»´æŠ¤å¤æ‚ç»„ä»¶å˜å¾—å›°éš¾ã€‚é€‰é¡¹çš„åˆ†ç¦»æ©ç›–äº†æ½œåœ¨çš„é€»è¾‘é—®é¢˜ã€‚æ­¤å¤–ï¼Œåœ¨å¤„ç†å•ä¸ªé€»è¾‘å…³æ³¨ç‚¹æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä¸æ–­åœ°â€œè·³è½¬â€ç›¸å…³ä»£ç çš„é€‰é¡¹å—ã€‚</p> <p>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå°†ä¸åŒä¸€ä¸ªé€»è¾‘å…³æ³¨ç‚¹ç›¸å…³çš„ä»£ç é…ç½®åœ¨ä¸€èµ·ä¼šæ›´å¥½ã€‚è€Œè¿™æ­£æ˜¯ç»„åˆå¼ API ä½¿æˆ‘ä»¬èƒ½å¤Ÿåšåˆ°çš„ã€‚</p> <h2 id="_5-1-åŸºç¡€ç”¨æ³•"><a href="#_5-1-åŸºç¡€ç”¨æ³•" class="header-anchor">#</a> 5.1 åŸºç¡€ç”¨æ³•</h2> <p>ä¸ºäº†å¼€å§‹ä½¿ç”¨ç»„åˆå¼ APIï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ªå¯ä»¥å®é™…ä½¿ç”¨å®ƒçš„åœ°æ–¹ã€‚åœ¨ Vue ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†æ­¤ä½ç½®ç§°ä¸º <code>setup</code>ã€‚</p> <p><code>setup</code> é€‰é¡¹åº”è¯¥æ˜¯ä¸€ä¸ªæ¥å— <code>props</code> å’Œ <code>context</code> çš„å‡½æ•°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä» <code>setup</code> è¿”å›çš„æ‰€æœ‰å†…å®¹éƒ½å°†æš´éœ²ç»™ç»„ä»¶çš„å…¶ä½™éƒ¨åˆ† (è®¡ç®—å±æ€§ã€æ–¹æ³•ã€ç”Ÿå‘½å‘¨æœŸé’©å­ç­‰ç­‰) ä»¥åŠç»„ä»¶çš„æ¨¡æ¿ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> RepositoriesFilters<span class="token punctuation">,</span> RepositoriesSortBy<span class="token punctuation">,</span> RepositoriesList <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token comment">// { user: '' }</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// è¿™é‡Œè¿”å›çš„ä»»ä½•å†…å®¹éƒ½å¯ä»¥ç”¨äºç»„ä»¶çš„å…¶ä½™éƒ¨åˆ†</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ç»„ä»¶çš„â€œå…¶ä½™éƒ¨åˆ†â€</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ç”±äºåœ¨æ‰§è¡Œ <code>setup</code> æ—¶ï¼Œå°šæœªåˆ›å»ºç»„ä»¶å®ä¾‹ï¼Œå› æ­¤åœ¨ <code>setup</code> é€‰é¡¹ä¸­æ²¡æœ‰ <code>this</code>ã€‚è¿™æ„å‘³ç€ï¼Œé™¤äº† <code>props</code> ä¹‹å¤–ï¼Œä½ å°†æ— æ³•è®¿é—®ç»„ä»¶ä¸­å£°æ˜çš„ä»»ä½•å±æ€§â€”â€”<strong>æœ¬åœ°çŠ¶æ€</strong>ã€<strong>è®¡ç®—å±æ€§</strong>æˆ–<strong>æ–¹æ³•</strong>ã€‚</p></blockquote> <p>ä¾‹å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/components/UserRepositories.vue `setup` function</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchUserRepositories <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/repositories'</span>

<span class="token comment">// åœ¨æˆ‘ä»¬çš„ç»„ä»¶å†…</span>
<span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> repositories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getUserRepositories</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    repositories <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUserRepositories</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">,</span>
    getUserRepositories <span class="token comment">// è¿”å›çš„å‡½æ•°ä¸æ–¹æ³•çš„è¡Œä¸ºç›¸åŒ</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬çš„ <code>repositories</code> å˜é‡æ˜¯éå“åº”å¼çš„ï¼Œéœ€è¦å°†å…¶å˜æˆå“åº”å¼çš„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/components/UserRepositories.vue `setup` function</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchUserRepositories <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/repositories'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// in our component</span>
<span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> repositories <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getUserRepositories</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUserRepositories</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">,</span>
    getUserRepositories
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨ï¼Œæ¯å½“æˆ‘ä»¬è°ƒç”¨ <code>getUserRepositories</code> æ—¶ï¼Œ<code>repositories</code> éƒ½å°†å‘ç”Ÿå˜åŒ–ï¼Œè§†å›¾å°†æ›´æ–°ä»¥åæ˜ æ›´æ”¹ã€‚æˆ‘ä»¬çš„ç»„ä»¶ç°åœ¨åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/components/UserRepositories.vue</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchUserRepositories <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/repositories'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> RepositoriesFilters<span class="token punctuation">,</span> RepositoriesSortBy<span class="token punctuation">,</span> RepositoriesList <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> repositories <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">getUserRepositories</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      repositories<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUserRepositories</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      repositories<span class="token punctuation">,</span>
      getUserRepositories
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      filters<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 3</span>
      searchQuery<span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// 2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">filteredRepositories</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 3</span>
    <span class="token function">repositoriesMatchingSearchQuery</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 2</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token string">'getUserRepositories'</span> <span class="token comment">// 1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">updateFilters</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 3</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUserRepositories</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½¿ç”¨åœ¨ setup å†…éƒ¨ä¹¦å†™ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸ä¾¦å¬å™¨çš„æ–¹å¼æ¥æ”¹å†™åï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/components/UserRepositories.vue `setup` function</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchUserRepositories <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/repositories'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// åœ¨æˆ‘ä»¬ç»„ä»¶ä¸­</span>
<span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä½¿ç”¨ `toRefs` åˆ›å»ºå¯¹propçš„ `user` property çš„å“åº”å¼å¼•ç”¨</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>

  <span class="token keyword">const</span> repositories <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getUserRepositories</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ›´æ–° `prop.user` åˆ° `user.value` è®¿é—®å¼•ç”¨å€¼</span>
    repositories<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUserRepositories</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">onMounted</span><span class="token punctuation">(</span>getUserRepositories<span class="token punctuation">)</span>

  <span class="token comment">// åœ¨ç”¨æˆ· prop çš„å“åº”å¼å¼•ç”¨ä¸Šè®¾ç½®ä¸€ä¸ªä¾¦å¬å™¨</span>
  <span class="token function">watch</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> getUserRepositories<span class="token punctuation">)</span>
  
  <span class="token keyword">const</span> searchQuery <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> repositoriesMatchingSearchQuery <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> repositories<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
      <span class="token parameter">repository</span> <span class="token operator">=&gt;</span> repository<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>searchQuery<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">,</span>
    getUserRepositories
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬åœ¨ <code>setup</code> çš„é¡¶éƒ¨ä½¿ç”¨äº† <code>toRefs</code>ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„ä¾¦å¬å™¨èƒ½å¤Ÿå¯¹ <code>user</code> prop æ‰€åšçš„æ›´æ”¹åšå‡ºååº”ã€‚</p> <p>è¿™æ ·å­ï¼Œsetup ä¸­çš„å†…å®¹ä¼šå˜å¾—éå¸¸å¤šï¼Œæˆ‘ä»¬å¯ä»¥å°†éƒ¨åˆ†åŠŸèƒ½æå–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„<code>ç»„åˆå¼å‡½æ•°</code>ä¸­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/composables/useUserRepositories.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchUserRepositories <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/repositories'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">useUserRepositories</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> repositories <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getUserRepositories</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUserRepositories</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">onMounted</span><span class="token punctuation">(</span>getUserRepositories<span class="token punctuation">)</span>
  <span class="token function">watch</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> getUserRepositories<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">,</span>
    getUserRepositories
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/composables/useRepositoryNameSearch.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">useRepositoryNameSearch</span><span class="token punctuation">(</span><span class="token parameter">repositories</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> searchQuery <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> repositoriesMatchingSearchQuery <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> repositories<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">repository</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> repository<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>searchQuery<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    searchQuery<span class="token punctuation">,</span>
    repositoriesMatchingSearchQuery
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­æœ‰äº†è¿™ä¸¤ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å®ƒä»¬äº†ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/components/UserRepositories.vue</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> useUserRepositories <span class="token keyword">from</span> <span class="token string">'@/composables/useUserRepositories'</span>
<span class="token keyword">import</span> useRepositoryNameSearch <span class="token keyword">from</span> <span class="token string">'@/composables/useRepositoryNameSearch'</span>
<span class="token keyword">import</span> useRepositoryFilters <span class="token keyword">from</span> <span class="token string">'@/composables/useRepositoryFilters'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> RepositoriesFilters<span class="token punctuation">,</span> RepositoriesSortBy<span class="token punctuation">,</span> RepositoriesList <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> repositories<span class="token punctuation">,</span> getUserRepositories <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useUserRepositories</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span>
      searchQuery<span class="token punctuation">,</span>
      repositoriesMatchingSearchQuery
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRepositoryNameSearch</span><span class="token punctuation">(</span>repositories<span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span>
      filters<span class="token punctuation">,</span>
      updateFilters<span class="token punctuation">,</span>
      filteredRepositories
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRepositoryFilters</span><span class="token punctuation">(</span>repositoriesMatchingSearchQuery<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      repositories<span class="token operator">:</span> filteredRepositories<span class="token punctuation">,</span>
      getUserRepositories<span class="token punctuation">,</span>
      searchQuery<span class="token punctuation">,</span>
      filters<span class="token punctuation">,</span>
      updateFilters
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ ·å°±å·²ç»å®Œæˆäº†æƒ³è¦è¾¾åˆ°çš„ç›®çš„ã€‚è¿™å°±æ˜¯ç»„åˆå¼ API çš„ç”¨æ³•ã€‚</p> <h2 id="_5-2-setup"><a href="#_5-2-setup" class="header-anchor">#</a> 5.2 Setup</h2> <p>ä½¿ç”¨ <code>setup</code> å‡½æ•°æ—¶ï¼Œå®ƒå°†æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p> <ol><li><code>props</code></li> <li><code>context</code></li></ol> <p>è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°ç ”ç©¶å¦‚ä½•ä½¿ç”¨æ¯ä¸ªå‚æ•°ã€‚</p> <h3 id="_5-2-1-props"><a href="#_5-2-1-props" class="header-anchor">#</a> 5.2.1 Props</h3> <p><code>setup</code> å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>props</code>ã€‚æ­£å¦‚åœ¨ä¸€ä¸ªæ ‡å‡†ç»„ä»¶ä¸­æ‰€æœŸæœ›çš„é‚£æ ·ï¼Œ<code>setup</code> å‡½æ•°ä¸­çš„ <code>props</code> æ˜¯å“åº”å¼çš„ï¼Œå½“ä¼ å…¥æ–°çš„ prop æ—¶ï¼Œå®ƒå°†è¢«æ›´æ–°ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MyBook.vue</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> String
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ä½†æ˜¯ï¼Œå› ä¸º <code>props</code> æ˜¯å“åº”å¼çš„ï¼Œä½ <strong>ä¸èƒ½ä½¿ç”¨ ES6 è§£æ„</strong>ï¼Œå› ä¸ºå®ƒä¼šæ¶ˆé™¤ prop çš„å“åº”æ€§ã€‚</p></blockquote> <p>å¦‚æœéœ€è¦è§£æ„ propï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ <code>setup</code> å‡½æ•°ä¸­çš„ <code>toRefs</code> æ¥å®‰å…¨åœ°å®Œæˆæ­¤æ“ä½œã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MyBook.vue</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span> title <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>

	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-2-2-context"><a href="#_5-2-2-context" class="header-anchor">#</a> 5.2.2 context</h3> <p>ä¼ é€’ç»™ <code>setup</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ <code>context</code>ã€‚<code>context</code> æ˜¯ä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ï¼Œå®ƒæš´éœ²ä¸‰ä¸ªç»„ä»¶çš„ propertyï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MyBook.vue</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Attribute (éå“åº”å¼å¯¹è±¡)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>attrs<span class="token punctuation">)</span>

    <span class="token comment">// æ’æ§½ (éå“åº”å¼å¯¹è±¡)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>slots<span class="token punctuation">)</span>

    <span class="token comment">// è§¦å‘äº‹ä»¶ (æ–¹æ³•)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>emit<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>context</code> æ˜¯ä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¸æ˜¯å“åº”å¼çš„ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å®‰å…¨åœ°å¯¹ <code>context</code> ä½¿ç”¨ ES6 è§£æ„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MyBook.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> attrs<span class="token punctuation">,</span> slots<span class="token punctuation">,</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>attrs</code> å’Œ <code>slots</code> æ˜¯æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼Œå®ƒä»¬æ€»æ˜¯ä¼šéšç»„ä»¶æœ¬èº«çš„æ›´æ–°è€Œæ›´æ–°ã€‚è¿™æ„å‘³ç€ä½ åº”è¯¥é¿å…å¯¹å®ƒä»¬è¿›è¡Œè§£æ„ï¼Œå¹¶å§‹ç»ˆä»¥ <code>attrs.x</code> æˆ– <code>slots.x</code> çš„æ–¹å¼å¼•ç”¨ propertyã€‚</p> <blockquote><p>ä½†è¯·æ³¨æ„ï¼Œä¸ <code>props</code> ä¸åŒï¼Œ<code>attrs</code> å’Œ <code>slots</code> æ˜¯<strong>é</strong>å“åº”å¼çš„ã€‚å¦‚æœä½ æ‰“ç®—æ ¹æ® <code>attrs</code> æˆ– <code>slots</code> æ›´æ”¹åº”ç”¨å‰¯ä½œç”¨ï¼Œé‚£ä¹ˆåº”è¯¥åœ¨ <code>onUpdated</code> ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­æ‰§è¡Œæ­¤æ“ä½œã€‚</p></blockquote> <p>æ‰§è¡Œ <code>setup</code> æ—¶ï¼Œç»„ä»¶å®ä¾‹å°šæœªè¢«åˆ›å»ºã€‚å› æ­¤ï¼Œä½ åªèƒ½è®¿é—®ä»¥ä¸‹ propertyï¼š</p> <ul><li><code>props</code></li> <li><code>attrs</code></li> <li><code>slots</code></li> <li><code>emit</code></li></ul> <p>æ¢å¥è¯è¯´ï¼Œä½ <strong>å°†æ— æ³•è®¿é—®</strong>ä»¥ä¸‹ç»„ä»¶é€‰é¡¹ï¼š</p> <ul><li><code>data</code></li> <li><code>computed</code></li> <li><code>methods</code></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/Vue3/introduce.html" class="prev">
        1. Vue3 åˆæ­¥ä»‹ç»
      </a></span> <span class="next"><a href="/Vue3/migration.html">
        1. v-for ä¸­çš„ Ref æ•°ç»„
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.356218c2.js" defer></script><script src="/assets/js/2.1547bbba.js" defer></script><script src="/assets/js/15.a09c666d.js" defer></script>
  </body>
</html>
