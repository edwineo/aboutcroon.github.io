<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Git使用规范 | Chang Liu</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/hero.JPG">
    <meta name="description" content="Replace the stars and rivers in the body with unlimited methods for the future">
    
    <link rel="preload" href="/assets/css/0.styles.a7f15fef.css" as="style"><link rel="preload" href="/assets/js/app.783a6ee2.js" as="script"><link rel="preload" href="/assets/js/2.5a5ecfa5.js" as="script"><link rel="preload" href="/assets/js/18.e858c77d.js" as="script"><link rel="prefetch" href="/assets/js/10.930de106.js"><link rel="prefetch" href="/assets/js/11.aa3cc023.js"><link rel="prefetch" href="/assets/js/12.dcec06ad.js"><link rel="prefetch" href="/assets/js/13.0bc6ce2c.js"><link rel="prefetch" href="/assets/js/14.5819cd37.js"><link rel="prefetch" href="/assets/js/15.e2a5d174.js"><link rel="prefetch" href="/assets/js/16.048335b4.js"><link rel="prefetch" href="/assets/js/17.a2a10b60.js"><link rel="prefetch" href="/assets/js/19.3afed449.js"><link rel="prefetch" href="/assets/js/20.10250f3f.js"><link rel="prefetch" href="/assets/js/21.415c0272.js"><link rel="prefetch" href="/assets/js/3.60419601.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.f3e6ed41.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.bed22aa2.js"><link rel="prefetch" href="/assets/js/8.67be8f05.js"><link rel="prefetch" href="/assets/js/9.fb3321fe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a7f15fef.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Chang Liu</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="目录" class="dropdown-title"><span class="title">目录</span> <span class="arrow down"></span></button> <button type="button" aria-label="目录" class="mobile-dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/" class="nav-link">
  Vue3源码分析
</a></li><li class="dropdown-item"><!----> <a href="/standard/" class="nav-link router-link-active">
  前端规范
</a></li><li class="dropdown-item"><!----> <a href="/code/" class="nav-link">
  源码分析
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.cn/user/4186540684871485" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/aboutcroon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="目录" class="dropdown-title"><span class="title">目录</span> <span class="arrow down"></span></button> <button type="button" aria-label="目录" class="mobile-dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/" class="nav-link">
  Vue3源码分析
</a></li><li class="dropdown-item"><!----> <a href="/standard/" class="nav-link router-link-active">
  前端规范
</a></li><li class="dropdown-item"><!----> <a href="/code/" class="nav-link">
  源码分析
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.cn/user/4186540684871485" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/aboutcroon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/standard/" aria-current="page" class="sidebar-link">前言</a></li><li><a href="/standard/js.html" class="sidebar-link">JavaScript规范及命名</a></li><li><a href="/standard/css.html" class="sidebar-link">CSS规范及命名</a></li><li><a href="/standard/http.html" class="sidebar-link">HTTP请求规范</a></li><li><a href="/standard/git.html" aria-current="page" class="active sidebar-link">Git使用规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/standard/git.html#_1-1-分支命名" class="sidebar-link">1.1 分支命名</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_1-2-分支保护" class="sidebar-link">1.2 分支保护</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_2-1-基本格式" class="sidebar-link">2.1 基本格式</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_2-2-header" class="sidebar-link">2.2 Header</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_2-3-body" class="sidebar-link">2.3 Body</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_2-4-footer" class="sidebar-link">2.4 Footer</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_3-1-commitizen" class="sidebar-link">3.1 Commitizen</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_3-2-具体使用" class="sidebar-link">3.2 具体使用</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_4-1-具体使用" class="sidebar-link">4.1 具体使用</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_4-2-配置规则" class="sidebar-link">4.2 配置规则</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_5-1-具体使用" class="sidebar-link">5.1 具体使用</a></li><li class="sidebar-sub-header"><a href="/standard/git.html#_5-2-配置规则" class="sidebar-link">5.2 配置规则</a></li></ul></li><li><a href="/standard/vscode.html" class="sidebar-link">VsCode常用插件及功能</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="git使用规范"><a href="#git使用规范" class="header-anchor">#</a> Git使用规范</h1> <h1 id="_1-分支命名与保护"><a href="#_1-分支命名与保护" class="header-anchor">#</a> 1. 分支命名与保护</h1> <h2 id="_1-1-分支命名"><a href="#_1-1-分支命名" class="header-anchor">#</a> 1.1 分支命名</h2> <h3 id="_1-1-1-master-主分支"><a href="#_1-1-1-master-主分支" class="header-anchor">#</a> 1.1.1 master（主分支）</h3> <ul><li>主分支，线上环境</li> <li>该分支为只读分支，只能从 <code>test</code> 分支合并，不能直接在此分支上进行修改</li> <li>所有在 <code>master</code> 分支的推送应该打标签做记录，方便追溯</li></ul> <h3 id="_1-1-2-dev-主开发分支"><a href="#_1-1-2-dev-主开发分支" class="header-anchor">#</a> 1.1.2 dev（主开发分支）</h3> <ul><li>主开发分支，基于 <code>master</code> 分支克隆</li> <li>该分支为只读分支，只能从其他分支（<code>feature/hotfix</code>）合并，不能直接在此分支上进行修改</li> <li>包含所有要发布到下一个 <code>test</code> 分支的代码</li> <li>feature 功能分支开发完成时，合并到 <code>dev</code> 分支</li></ul> <h3 id="_1-1-3-release-预发布分支"><a href="#_1-1-3-release-预发布分支" class="header-anchor">#</a> 1.1.3 release（预发布分支）</h3> <ul><li>预发布分支，基于 <code>dev</code> 分支克隆</li> <li>当有一组 feature 开发完成，首先会合并到 dev 分支，进入提测时，会基于 dev 分支创建 release 分支进行测试</li> <li>如果测试过程中若存在 bug 需要修复，则直接由开发者在 release 分支修复并提交，修复完成之后合并到 dev 分支</li></ul> <h3 id="_1-1-4-feature-功能开发分支"><a href="#_1-1-4-feature-功能开发分支" class="header-anchor">#</a> 1.1.4 feature （功能开发分支）</h3> <ul><li>功能开发分支，基于 <code>dev</code> 分支克隆</li> <li>开发新功能时，需要从 <code>dev</code> 分支拉取 <code>feature</code> 分支，分支命名为 feature-功能名称/模块名称</li> <li>开发完成后，将代码合并到 <code>dev</code> 分支，并删除该分支</li></ul> <h3 id="_1-1-5-hotfix-bug-修复分支"><a href="#_1-1-5-hotfix-bug-修复分支" class="header-anchor">#</a> 1.1.5 hotfix（bug 修复分支）</h3> <ul><li>补丁分支，基于 <code>master</code> 分支克隆，主要用于对线上版本进行 bug 修复</li> <li>命名为 hotfix-bug模块名称，修复完毕后合并到 <code>dev</code> 分支</li> <li>属于临时分支，补丁修复上线后可删除该分支</li></ul> <h2 id="_1-2-分支保护"><a href="#_1-2-分支保护" class="header-anchor">#</a> 1.2 分支保护</h2> <p>设置 <code>master</code> 分支、<code>test</code> 分支、<code>dev</code> 分支只能通过 merge request 的方式合并，不可以直接 push 代码。</p> <p>由负责人进行 <code>code review</code> 之后再合并到相应分支。</p> <h1 id="_2-commit-message-规范"><a href="#_2-commit-message-规范" class="header-anchor">#</a> 2. Commit message 规范</h1> <p>参考于 Angular 定义的 commit 基本格式</p> <p><a href="https://github.com/angular/angular/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">参考文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/angular/angular/commits/master" target="_blank" rel="noopener noreferrer">具体示例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2-1-基本格式"><a href="#_2-1-基本格式" class="header-anchor">#</a> 2.1 基本格式</h2> <p>基本格式如下：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>): <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>subject</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>第一行的 <code>Header</code> 部分为必填，<code>Body</code> 和 <code>Footer</code> 部分为可选。注意 Header，Body，Footer 中间有空白行分割。</p> <h2 id="_2-2-header"><a href="#_2-2-header" class="header-anchor">#</a> 2.2 Header</h2> <p>Header 部分只有一行，包括三个字段：<code>type</code>(必需)、<code>scope</code>(可选)、<code>subject</code>(必需)。</p> <h3 id="type"><a href="#type" class="header-anchor">#</a> type：</h3> <p><code>type</code> 用于说明 commit 的类别，只允许使用以下 7 个标识</p> <ul><li><code>feat</code>：新功能（feature）</li> <li><code>fix</code>：修补 bug</li> <li><code>docs</code>：文档（documentation）</li> <li><code>style</code>：格式（不影响代码运行的变动）</li> <li><code>refactor</code>：重构（不是新增的功能，也不是修改 bug 的代码变动）</li> <li><code>test</code>：增加测试</li> <li><code>chore</code>：构建过程或辅助工具的变动</li></ul> <p>通常 feat 和 fix 会被放入 changelog（变更日志） 中，其他类型则不会。</p> <h3 id="scope"><a href="#scope" class="header-anchor">#</a> scope：</h3> <p><code>scope</code> 用于说明 commit 影响的范围，为可选值。通常是文件、路径、功能等</p> <h3 id="subject"><a href="#subject" class="header-anchor">#</a> subject：</h3> <p><code>subject</code> 是 commit 目的的简短描述，不超过 50 个字符，一般用英文表示</p> <ul><li>以动词开头，使用第一人称现在时，比如 <code>change</code>，而不是 <code>changed</code> 或 <code>changes</code></li> <li>第一个字母小写</li> <li>结尾不加句号 (.)</li></ul> <h2 id="_2-3-body"><a href="#_2-3-body" class="header-anchor">#</a> 2.3 Body</h2> <p><code>Body</code> 部分是对本次 commit 的详细描述，为可选项，可以分成多行（换行用 \n），示例：</p> <div class="language- extra-class"><pre class="language-text"><code>More detailed explanatory text, if necessary. 
Further paragraphs come after blank lines. 

- Bullet points are okay, too 
- Use a hanging indent
</code></pre></div><h2 id="_2-4-footer"><a href="#_2-4-footer" class="header-anchor">#</a> 2.4 Footer</h2> <p><code>Footer</code> 部分只用于两种情况：</p> <h3 id="不兼容的变动"><a href="#不兼容的变动" class="header-anchor">#</a> 不兼容的变动</h3> <p>如果当前代码与上一个版本不兼容，则 Footer 部分以 <code>BREAKING CHANGE</code> 开头，后面加上对变动的描述、变动理由以及迁移方法。</p> <h3 id="关闭问题"><a href="#关闭问题" class="header-anchor">#</a> 关闭问题</h3> <p>如果当前 commit 针对某个问题，那么可以在 Footer 部分关闭这个问题：</p> <div class="language- extra-class"><pre class="language-text"><code>Closes #234
</code></pre></div><p>也可以一次关闭多个问题：</p> <div class="language- extra-class"><pre class="language-text"><code>Closes #123, #245, #992
</code></pre></div><h1 id="_3-自动化工具处理-commit-message"><a href="#_3-自动化工具处理-commit-message" class="header-anchor">#</a> 3. 自动化工具处理 commit message</h1> <p>如 commit message 规则所示，若我们手写上述的 commit 基本格式很明显并不方便，而且还有出错的可能，那么可以使用自动化工具生成上述规范的commit message。</p> <h2 id="_3-1-commitizen"><a href="#_3-1-commitizen" class="header-anchor">#</a> 3.1 Commitizen</h2> <p>我们可以使用 <a href="https://github.com/commitizen/cz-cli" target="_blank" rel="noopener noreferrer">commitizen<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 工具来规范化 git commit 的 message。</p> <p>commitizen 本质上是一个通用的规范化 git commit 的框架，可以通过各种 <a href="https://github.com/commitizen/cz-cli#adapters" target="_blank" rel="noopener noreferrer">Adapters<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来格式化对应的格式。我们上述使用的规则是 Angular 的 commit 格式，那么需要额外安装 cz-conventional-changelog 这个 Adapter。目前 commitizen 实现的 Adaptor 有 Angular、ESlint、mapbox、Jira 等等，我们这里只使用 cz-conventional-changelog 来实现 Angular 的 commit 格式。</p> <h2 id="_3-2-具体使用"><a href="#_3-2-具体使用" class="header-anchor">#</a> 3.2 具体使用</h2> <p>全局安装 commitizen</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code>npm install commitizen <span class="token operator">-</span>g
</code></pre></div><p>使用 commitizen 命令初始化当前工程</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code>commitizen init cz<span class="token operator">-</span>conventional<span class="token operator">-</span>changelog <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre></div><p>执行完毕后，在 package.json 文件中的 devDependencies 配置中多了 cz-conventional-changelog 依赖，也增加了以下配置段</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules/cz-conventional-changelog&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此时，使用 <code>git cz</code> 命令来替换 git commit 命令即可。</p> <h1 id="_4-git-hook-设置-commit-message-校验"><a href="#_4-git-hook-设置-commit-message-校验" class="header-anchor">#</a> 4. Git hook 设置 commit message 校验</h1> <p>我们可以在 git commit 的 hook 中加入 <a href="https://github.com/conventional-changelog/commitlint" target="_blank" rel="noopener noreferrer">commitlint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 校验，这样可以使不符合 commit 规范的本地提交无法完成。</p> <h2 id="_4-1-具体使用"><a href="#_4-1-具体使用" class="header-anchor">#</a> 4.1 具体使用</h2> <p>在项目中安装 husky，commitlint 相关依赖</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code>npm install husky @commitlint<span class="token operator">/</span>config<span class="token operator">-</span>conventional @commitlint<span class="token operator">/</span>cli <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre></div><p>在 package.json 文件中添加 husky 的 git hook 配置</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commitlint -x @commitlint/config-conventional -E HUSKY_GIT_PARAMS&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此时，如果提交的 commit message 不符合规范，该 hook 就会报错。</p> <h2 id="_4-2-配置规则"><a href="#_4-2-配置规则" class="header-anchor">#</a> 4.2 配置规则</h2> <p>我们可以生成 <code>commitlint.config.js</code> 或 <code>.commitlintrc.js</code> 文件来配置自定义的规则：</p> <div class="language- extra-class"><pre class="language-text"><code>echo &quot;module.exports = {extends: ['@commitlint/config-conventional']}&quot; &gt; commitlint.config.js
</code></pre></div><p>commitlint.config.js 文件的配置如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@commitlint/config-conventional&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'type-enum'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
      <span class="token string">'upd'</span><span class="token punctuation">,</span> <span class="token string">'feat'</span><span class="token punctuation">,</span> <span class="token string">'fix'</span><span class="token punctuation">,</span> <span class="token string">'refactor'</span><span class="token punctuation">,</span> <span class="token string">'docs'</span><span class="token punctuation">,</span> <span class="token string">'chore'</span><span class="token punctuation">,</span> <span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token string">'revert'</span>
     <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'type-case'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'type-empty'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'scope-empty'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'scope-case'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'subject-full-stop'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'subject-case'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'never'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'header-max-length'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'always'</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>rules 由 name 和配置数组组成，如：&quot; 'name': [0, 'always', 72] &quot;，数组中第一位为 level，可选 0，1，2，0 为 disable，1 为 warning，2 为 error；第二位为应用与否，可选 always 或 never；第三位为该 rule 的值。</p> <p>更多配置规则可参照 commitlint 官方网站：<a href="https://commitlint.js.org/#/reference-rules" target="_blank" rel="noopener noreferrer">commitlint rules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="_5-git-hook-设置-eslint-校验及修复"><a href="#_5-git-hook-设置-eslint-校验及修复" class="header-anchor">#</a> 5. Git hook 设置 eslint 校验及修复</h1> <p>我们也可以在 git commit 的 hook 中加入 <a href="https://github.com/okonet/lint-staged#readme" target="_blank" rel="noopener noreferrer">lint-staged<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 校验，用来对 git 暂存的文件执行 lint 修复。</p> <h2 id="_5-1-具体使用"><a href="#_5-1-具体使用" class="header-anchor">#</a> 5.1 具体使用</h2> <p>安装 husky、lint-staged 和 eslint 依赖</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code>npm install husky lint<span class="token operator">-</span>staged eslint <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre></div><p>在 package.json 文件中增加 husky 和 lint-staged 配置</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;husky&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token property">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;src/**&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;eslint --fix&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_5-2-配置规则"><a href="#_5-2-配置规则" class="header-anchor">#</a> 5.2 配置规则</h2> <p>上述 lint 修复会根据 .eslintrc.js 文件中的配置进行。</p> <p>eslint 配置规则详见：<a href="http://10.10.1.21:8050/display/FRON/eslint" target="_blank" rel="noopener noreferrer">eslint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/standard/http.html" class="prev">
        HTTP请求规范
      </a></span> <span class="next"><a href="/standard/vscode.html">
        VsCode常用插件及功能
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.783a6ee2.js" defer></script><script src="/assets/js/2.5a5ecfa5.js" defer></script><script src="/assets/js/18.e858c77d.js" defer></script>
  </body>
</html>
